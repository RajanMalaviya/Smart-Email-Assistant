2025-09-11 15:09:03,732 [INFO] services.db_service - Connecting to MongoDB at mongodb+srv://***:***@cluster0.yrdrirj.mongodb.net/ (db='smart_email_db', collection='emails')
2025-09-11 15:09:04,055 [DEBUG] pymongo.topology - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68c298b7758b654bb8742225"}}
2025-09-11 15:09:04,056 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "previousDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 15:09:04,056 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,057 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,057 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,058 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,061 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,064 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,066 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c298b7758b654bb8742225"}}
2025-09-11 15:09:04,067 [DEBUG] pymongo.serverSelection - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "remainingTimeMS": 4999}
2025-09-11 15:09:04,208 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 15:09:04,215 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 15:09:04,231 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "driverConnectionId": 1, "serverConnectionId": 186739, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 22.223599953576922, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"ismaster\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"workloadType\": \"OPERATIONAL\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az3\", \"nodeType\": \"ELECTABLE\", \"region\": \"AP_SOUTH_1\", \"diskState\": \"READY\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T09:38:59Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T09:38:59Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes..."}
2025-09-11 15:09:04,241 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,241 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "previousDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 15:09:04,243 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 15:09:04,244 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,245 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,246 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "driverConnectionId": 1, "serverConnectionId": 186739, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 15:09:04,247 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "driverConnectionId": 1, "serverConnectionId": 179281, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 31.03519999422133, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"availabilityZone\": \"aps1-az1\", \"provider\": \"AWS\", \"region\": \"AP_SOUTH_1\", \"diskState\": \"READY\", \"workloadType\": \"OPERATIONAL\", \"nodeType\": \"ELECTABLE\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T09:38:59Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T09:38:59Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 15:09:04,247 [DEBUG] pymongo.connection - {"message": "Connection created", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 15:09:04,250 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,252 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "previousDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03103519999422133>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 15:09:04,254 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "driverConnectionId": 1, "serverConnectionId": 179281, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 15:09:04,270 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "driverConnectionId": 1, "serverConnectionId": 177049, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 26.687599951401353, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"region\": \"AP_SOUTH_1\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T09:38:59Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T09:38:59Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 15:09:04,273 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,274 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "previousDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03103519999422133>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03103519999422133>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.026687599951401353>]>"}
2025-09-11 15:09:04,277 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "driverConnectionId": 1, "serverConnectionId": 177049, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 15:09:04,489 [DEBUG] pymongo.connection - {"message": "Connection ready", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.12373730004765093}
2025-09-11 15:09:04,489 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.24400240008253604}
2025-09-11 15:09:04,490 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "command": "{\"buildinfo\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"SqpK8mwCTiyr6hbM+3+yWA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"mJDsfXzJ5DtSNfYFZ9muLQlihX8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"admin\"}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 186740, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,515 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "durationMS": 25.412, "reply": "{\"version\": \"8.0.13\", \"gitVersion\": \"8dc5cd2a30c4524132e2d44bb314544dc477e611\", \"modules\": [\"enterprise\"], \"allocator\": \"tcmalloc-google\", \"javascriptEngine\": \"mozjs\", \"sysInfo\": \"deprecated\", \"versionArray\": [8, 13], \"bits\": 64, \"maxBsonObjectSize\": 16777216, \"storageEngines\": [\"devnull\", \"inMemory\", \"queryable_wt\", \"wiredTiger\"], \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"mJDsfXzJ5DtSNfYFZ9muLQlihX8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 186740, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,517 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 15:09:04,517 [INFO] services.db_service - Connected to MongoDB successfully
2025-09-11 15:09:04,519 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000019F17825BC0>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03103519999422133>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.026687599951401353>]>", "clientId": {"$oid": "68c298b7758b654bb8742225"}}
2025-09-11 15:09:04,520 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000019F17825BC0>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03103519999422133>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.026687599951401353>]>", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,521 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,521 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0004176999209448695}
2025-09-11 15:09:04,522 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"unique\": true, \"name\": \"provider_msgid_unique\", \"key\": {\"provider\": 1, \"provider_message_id\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"SqpK8mwCTiyr6hbM+3+yWA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"mJDsfXzJ5DtSNfYFZ9muLQlihX8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 186740, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,566 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "durationMS": 43.952, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"mJDsfXzJ5DtSNfYFZ9muLQlihX8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 186740, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,566 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 15:09:04,567 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000019F17825BC0>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03103519999422133>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.026687599951401353>]>", "clientId": {"$oid": "68c298b7758b654bb8742225"}}
2025-09-11 15:09:04,567 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000019F17825BC0>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03103519999422133>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.026687599951401353>]>", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,567 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,567 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0001343999756500125}
2025-09-11 15:09:04,568 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"date_idx\", \"key\": {\"date\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"SqpK8mwCTiyr6hbM+3+yWA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"mJDsfXzJ5DtSNfYFZ9muLQlihX8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 186740, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,609 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "durationMS": 41.818, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"mJDsfXzJ5DtSNfYFZ9muLQlihX8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 186740, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,610 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 15:09:04,610 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000019F17825BC0>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03103519999422133>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.026687599951401353>]>", "clientId": {"$oid": "68c298b7758b654bb8742225"}}
2025-09-11 15:09:04,611 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000019F17825BC0>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03103519999422133>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.026687599951401353>]>", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,611 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,611 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0002133999951183796}
2025-09-11 15:09:04,611 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"from_idx\", \"key\": {\"from\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"SqpK8mwCTiyr6hbM+3+yWA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"mJDsfXzJ5DtSNfYFZ9muLQlihX8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 186740, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,663 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "durationMS": 51.122, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"mJDsfXzJ5DtSNfYFZ9muLQlihX8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 186740, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,664 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 15:09:04,664 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000019F17825BC0>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03103519999422133>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.026687599951401353>]>", "clientId": {"$oid": "68c298b7758b654bb8742225"}}
2025-09-11 15:09:04,665 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000019F17825BC0>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03103519999422133>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.026687599951401353>]>", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,665 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,666 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00037430005613714457}
2025-09-11 15:09:04,666 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"labels_idx\", \"key\": {\"labels\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"SqpK8mwCTiyr6hbM+3+yWA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"mJDsfXzJ5DtSNfYFZ9muLQlihX8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 186740, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,713 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "durationMS": 46.918, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"mJDsfXzJ5DtSNfYFZ9muLQlihX8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 186740, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:04,714 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 15:09:04,714 [INFO] services.db_service - MongoDB indexes ensured
2025-09-11 15:09:04,720 [INFO] __main__ - Starting Smart Email Assistant Backend
2025-09-11 15:09:04,736 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-11 15:09:04,737 [INFO] services.gmail_service - Refreshing expired Gmail token...
2025-09-11 15:09:04,745 [DEBUG] urllib3.connectionpool - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-09-11 15:09:05,079 [DEBUG] urllib3.connectionpool - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-09-11 15:09:05,081 [INFO] services.gmail_service - Token refreshed successfully
2025-09-11 15:09:05,082 [INFO] services.gmail_service - Saved Gmail token.json for future runs
2025-09-11 15:09:05,089 [INFO] googleapiclient.discovery_cache - file_cache is only supported with oauth2client<4.0.0
2025-09-11 15:09:05,127 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-11 15:09:05,127 [INFO] __main__ - Fetching up to 5 emails from Gmail...
2025-09-11 15:09:05,127 [INFO] services.gmail_service - Fetching 5 emails from Gmail inbox...
2025-09-11 15:09:05,132 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?labelIds=INBOX&maxResults=5&alt=json
2025-09-11 15:09:06,055 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/1993797cbb72a9f8?alt=json
2025-09-11 15:09:06,429 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199374924cbd9c11?alt=json
2025-09-11 15:09:06,791 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199374018a3537ad?alt=json
2025-09-11 15:09:07,149 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199372f48f5a3d5a?alt=json
2025-09-11 15:09:07,554 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/1993718a428b45ee?alt=json
2025-09-11 15:09:07,902 [INFO] services.gmail_service - Fetched 5 emails successfully
2025-09-11 15:09:07,902 [INFO] __main__ - Fetched 5 emails from Gmail
2025-09-11 15:09:07,903 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-11 15:09:07,904 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000019F17825BC0>", "operation": "insert", "operationId": -837470321, "topologyDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03103519999422133>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.026687599951401353>]>", "clientId": {"$oid": "68c298b7758b654bb8742225"}}
2025-09-11 15:09:07,904 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000019F17825BC0>", "operation": "insert", "operationId": -837470321, "topologyDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03103519999422133>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.026687599951401353>]>", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:07,904 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:07,905 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00027199997566640377}
2025-09-11 15:09:07,905 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "command": "{\"update\": \"emails\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"SqpK8mwCTiyr6hbM+3+yWA==\", \"subType\": \"04\"}}}, \"txnNumber\": 1, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757583539, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"mJDsfXzJ5DtSNfYFZ9muLQlihX8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\", \"updates\": [{\"q\": {\"provider\": \"gmail\", \"provider_message_id\": \"1993797cbb72a9f8\"}, \"u\": {\"$set\": {\"provider\": \"gmail\", \"provider_message_id\": \"1993797cbb72a9f8\", \"thread_id\": \"1993797cbb72a9f8\", \"from\": \"Rajan Malaviya <rajanmalaviya111@gmail.com>\", \"subject\": \"Test Mail\", \"snippet\": \"This is the testing email. Thanks!!\", \"labels\": [\"IMPORTANT\", \"CATEGORY_PERSONAL\", \"INBOX\"], \"fetched_at\": {\"$date\": \"2025-09-11T09:39:07.903Z\"}}, \"$setOnInsert\": {\"created_at\": {\"$date\": \"2025-09-11T09:39:07.903Z\"}}}, \"upsert\": true}, {\"q\": {\"provider\": \"gmail\", \"provider_message_id\": \"199374924cbd9c11\"}, \"u\": {\"$set\": {\"provider\": \"gmail\", \"provider_message_...", "commandName": "update", "databaseName": "smart_email_db", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 186740, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:07,940 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "durationMS": 35.199, "reply": "{\"n\": 5, \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757583544, \"i\": 5}}, \"t\": 75}, \"nModified\": 5, \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757583544, \"i\": 5}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"Z6g9tivWoTKzi72VgxquPlESOUQ=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757583544, \"i\": 5}}}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 186740, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:07,941 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 15:09:07,941 [INFO] services.db_service - Bulk upsert complete: Upserted 0, Modified 5
2025-09-11 15:09:07,941 [INFO] __main__ - Upsert Results: {'upserted_count': 0, 'modified_count': 5}
2025-09-11 15:09:07,943 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03103519999422133>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.026687599951401353>]>", "clientId": {"$oid": "68c298b7758b654bb8742225"}}
2025-09-11 15:09:07,943 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68c298b7758b654bb8742225, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03103519999422133>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.022223599953576922>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.026687599951401353>]>", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:07,943 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:07,943 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0001227000029757619}
2025-09-11 15:09:07,944 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "command": "{\"find\": \"emails\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"SqpK8mwCTiyr6hbM+3+yWA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757583544, \"i\": 5}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"Z6g9tivWoTKzi72VgxquPlESOUQ=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "find", "databaseName": "smart_email_db", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 186740, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:07,965 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "durationMS": 21.108999999999998, "reply": "{\"cursor\": {\"firstBatch\": [{\"provider\": \"gmail\", \"provider_message_id\": \"199374924cbd9c11\", \"created_at\": {\"$date\": \"2025-09-11T06:46:15.035Z\"}, \"fetched_at\": {\"$date\": \"2025-09-11T09:39:07.903Z\"}, \"from\": \"MongoDB Atlas <mongodb-atlas@mongodb.com>\", \"labels\": [\"IMPORTANT\", \"CATEGORY_UPDATES\", \"INBOX\"], \"snippet\": \"ORGANIZATION Rajan&#39;s Org - 2025-09-10 PROJECT Project 0 This is an informational notice to ensure you&#39;re aware that you&#39;ve added &quot;Allow access from anywhere (0.0.0.0/0)&quot; to your\", \"subject\": \"You've added \"Allow access from anywhere (0.0.0.0/0)\" to your Network Permission List\", \"thread_id\": \"199374924cbd9c11\"}, {\"provider_message_id\": \"199374018a3537ad\", \"provider\": \"gmail\", \"created_at\": {\"$date\": \"2025-09-11T06:46:15.035Z\"}, \"fetched_at\": {\"$date\": \"2025-09-11T09:39:07.903Z\"}, \"from\": \"Google <no-reply@accounts.google.com>\", \"labels\": [\"IMPORTANT\", \"CATEGORY_UPDATES\", \"INBOX\"], \"snippet\": \"You allowed Smart Email Assistant access to some of your Go...", "commandName": "find", "databaseName": "smart_email_db", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 186740, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:09:07,965 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 15:09:07,966 [INFO] services.db_service - Retrieved 6 emails from MongoDB
2025-09-11 15:09:07,966 [INFO] __main__ - Total stored emails in MongoDB: 6
2025-09-11 15:09:08,284 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 4029.677600017749, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 15:09:08,285 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 4039.0977000351995, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 15:09:08,331 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c298b7758b654bb8742225"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 4054.632299928926, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 15:21:14,534 [INFO] services.db_service - Connecting to MongoDB at mongodb+srv://***:***@cluster0.yrdrirj.mongodb.net/ (db='smart_email_db', collection='emails')
2025-09-11 15:21:14,743 [DEBUG] pymongo.topology - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}}
2025-09-11 15:21:14,743 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "previousDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 15:21:14,743 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:14,744 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:14,744 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:14,744 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:14,747 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:14,749 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:14,751 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}}
2025-09-11 15:21:14,751 [DEBUG] pymongo.serverSelection - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "remainingTimeMS": 4999}
2025-09-11 15:21:14,872 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 15:21:14,877 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 15:21:14,891 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 15:21:14,896 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "driverConnectionId": 1, "serverConnectionId": 179502, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 18.859000061638653, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"availabilityZone\": \"aps1-az1\", \"nodeType\": \"ELECTABLE\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"region\": \"AP_SOUTH_1\", \"provider\": \"AWS\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T09:51:11Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T09:51:11Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 15:21:14,898 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "driverConnectionId": 1, "serverConnectionId": 177264, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 25.27600002940744, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"diskState\": \"READY\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\", \"region\": \"AP_SOUTH_1\", \"workloadType\": \"OPERATIONAL\", \"nodeType\": \"ELECTABLE\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T09:51:11Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T09:51:11Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 15:21:14,900 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:14,902 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "previousDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 15:21:14,903 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:14,903 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "previousDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02527600002940744>]>"}
2025-09-11 15:21:14,904 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "driverConnectionId": 1, "serverConnectionId": 179502, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 15:21:14,905 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "driverConnectionId": 1, "serverConnectionId": 177264, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 15:21:14,916 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "driverConnectionId": 1, "serverConnectionId": 186953, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 24.333700072020292, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"ismaster\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"workloadType\": \"OPERATIONAL\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az3\", \"nodeType\": \"ELECTABLE\", \"region\": \"AP_SOUTH_1\", \"diskState\": \"READY\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T09:51:11Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T09:51:11Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes..."}
2025-09-11 15:21:14,917 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:14,917 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "previousDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02527600002940744>]>", "newDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024333700072020292>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02527600002940744>]>"}
2025-09-11 15:21:14,918 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024333700072020292>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02527600002940744>]>", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:14,918 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:14,919 [DEBUG] pymongo.connection - {"message": "Connection created", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 15:21:14,919 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "driverConnectionId": 1, "serverConnectionId": 186953, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 15:21:15,198 [DEBUG] pymongo.connection - {"message": "Connection ready", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.15840419998858124}
2025-09-11 15:21:15,199 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.28083399997558445}
2025-09-11 15:21:15,200 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "command": "{\"buildinfo\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"uUuKQ1k0R2ucshWIDvulag==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"FiolSIVkOxYWi/ntsqEvZNSqslY=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"admin\"}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 186964, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,224 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "durationMS": 24.080000000000002, "reply": "{\"version\": \"8.0.13\", \"gitVersion\": \"8dc5cd2a30c4524132e2d44bb314544dc477e611\", \"modules\": [\"enterprise\"], \"allocator\": \"tcmalloc-google\", \"javascriptEngine\": \"mozjs\", \"sysInfo\": \"deprecated\", \"versionArray\": [8, 13], \"bits\": 64, \"maxBsonObjectSize\": 16777216, \"storageEngines\": [\"devnull\", \"inMemory\", \"queryable_wt\", \"wiredTiger\"], \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"FiolSIVkOxYWi/ntsqEvZNSqslY=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 186964, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,225 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 15:21:15,225 [INFO] services.db_service - Connected to MongoDB successfully
2025-09-11 15:21:15,226 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000018ED4F75B20>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024333700072020292>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02527600002940744>]>", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}}
2025-09-11 15:21:15,226 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000018ED4F75B20>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024333700072020292>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02527600002940744>]>", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,227 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,227 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0002316000172868371}
2025-09-11 15:21:15,227 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"unique\": true, \"name\": \"provider_msgid_unique\", \"key\": {\"provider\": 1, \"provider_message_id\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"uUuKQ1k0R2ucshWIDvulag==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"FiolSIVkOxYWi/ntsqEvZNSqslY=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 186964, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,267 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "durationMS": 39.948, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"FiolSIVkOxYWi/ntsqEvZNSqslY=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 186964, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,268 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 15:21:15,268 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000018ED4F75B20>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024333700072020292>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02527600002940744>]>", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}}
2025-09-11 15:21:15,268 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000018ED4F75B20>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024333700072020292>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02527600002940744>]>", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,269 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,269 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00027710001450031996}
2025-09-11 15:21:15,269 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"date_idx\", \"key\": {\"date\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"uUuKQ1k0R2ucshWIDvulag==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"FiolSIVkOxYWi/ntsqEvZNSqslY=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 186964, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,306 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "durationMS": 36.817, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"FiolSIVkOxYWi/ntsqEvZNSqslY=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 186964, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,307 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 15:21:15,307 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000018ED4F75B20>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024333700072020292>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02527600002940744>]>", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}}
2025-09-11 15:21:15,308 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000018ED4F75B20>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024333700072020292>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02527600002940744>]>", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,308 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,309 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00027189997490495443}
2025-09-11 15:21:15,309 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"from_idx\", \"key\": {\"from\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"uUuKQ1k0R2ucshWIDvulag==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"FiolSIVkOxYWi/ntsqEvZNSqslY=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 186964, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,357 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "durationMS": 47.538, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"FiolSIVkOxYWi/ntsqEvZNSqslY=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 186964, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,357 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 15:21:15,358 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000018ED4F75B20>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024333700072020292>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02527600002940744>]>", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}}
2025-09-11 15:21:15,359 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000018ED4F75B20>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024333700072020292>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02527600002940744>]>", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,359 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,360 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0004802999319508672}
2025-09-11 15:21:15,360 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"labels_idx\", \"key\": {\"labels\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"uUuKQ1k0R2ucshWIDvulag==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"FiolSIVkOxYWi/ntsqEvZNSqslY=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 186964, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,399 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "durationMS": 38.767999999999994, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"FiolSIVkOxYWi/ntsqEvZNSqslY=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 186964, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:15,400 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 15:21:15,401 [INFO] services.db_service - MongoDB indexes ensured
2025-09-11 15:21:15,414 [INFO] __main__ - Starting Smart Email Assistant Backend
2025-09-11 15:21:15,453 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-11 15:21:15,462 [INFO] googleapiclient.discovery_cache - file_cache is only supported with oauth2client<4.0.0
2025-09-11 15:21:15,468 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-11 15:21:15,468 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-11 15:21:15,468 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-11 15:21:15,472 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?labelIds=INBOX&maxResults=10&alt=json
2025-09-11 15:21:16,312 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/1993797cbb72a9f8?alt=json
2025-09-11 15:21:16,738 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199374924cbd9c11?alt=json
2025-09-11 15:21:17,146 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199374018a3537ad?alt=json
2025-09-11 15:21:17,561 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199372f48f5a3d5a?alt=json
2025-09-11 15:21:17,968 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/1993718a428b45ee?alt=json
2025-09-11 15:21:18,381 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/19936d3d33cfe857?alt=json
2025-09-11 15:21:19,099 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199336433472cb67?alt=json
2025-09-11 15:21:19,510 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199331aaa4dc15d3?alt=json
2025-09-11 15:21:19,913 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/1993319d67463407?alt=json
2025-09-11 15:21:20,328 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199330cea0a5cb8a?alt=json
2025-09-11 15:21:20,726 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-11 15:21:20,727 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-11 15:21:20,727 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-11 15:21:20,729 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000018ED4F75B20>", "operation": "insert", "operationId": 740869814, "topologyDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024333700072020292>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02527600002940744>]>", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}}
2025-09-11 15:21:20,730 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000018ED4F75B20>", "operation": "insert", "operationId": 740869814, "topologyDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024333700072020292>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02527600002940744>]>", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:20,730 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:20,731 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.000462499912828207}
2025-09-11 15:21:20,732 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "command": "{\"update\": \"emails\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"uUuKQ1k0R2ucshWIDvulag==\", \"subType\": \"04\"}}}, \"txnNumber\": 1, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757584271, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"FiolSIVkOxYWi/ntsqEvZNSqslY=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\", \"updates\": [{\"q\": {\"provider\": \"gmail\", \"provider_message_id\": \"1993797cbb72a9f8\"}, \"u\": {\"$set\": {\"provider\": \"gmail\", \"provider_message_id\": \"1993797cbb72a9f8\", \"thread_id\": \"1993797cbb72a9f8\", \"from\": \"Rajan Malaviya <rajanmalaviya111@gmail.com>\", \"subject\": \"Test Mail\", \"snippet\": \"This is the testing email. Thanks!!\", \"labels\": [\"IMPORTANT\", \"CATEGORY_PERSONAL\", \"INBOX\"], \"fetched_at\": {\"$date\": \"2025-09-11T09:51:20.728Z\"}}, \"$setOnInsert\": {\"created_at\": {\"$date\": \"2025-09-11T09:51:20.728Z\"}}}, \"upsert\": true}, {\"q\": {\"provider\": \"gmail\", \"provider_message_id\": \"199374924cbd9c11\"}, \"u\": {\"$set\": {\"provider\": \"gmail\", \"provider_message_...", "commandName": "update", "databaseName": "smart_email_db", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 186964, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:20,809 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "durationMS": 77.351, "reply": "{\"n\": 10, \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757584277, \"i\": 10}}, \"t\": 75}, \"upserted\": [{\"index\": 6, \"_id\": {\"$oid\": \"68c29b952c6f45e31c3c8e8f\"}}, {\"index\": 7, \"_id\": {\"$oid\": \"68c29b952c6f45e31c3c8e90\"}}, {\"index\": 8, \"_id\": {\"$oid\": \"68c29b952c6f45e31c3c8e91\"}}, {\"index\": 9, \"_id\": {\"$oid\": \"68c29b952c6f45e31c3c8e92\"}}], \"nModified\": 6, \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757584277, \"i\": 10}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"82Camd1tIJlulfeEyHK+qwwZaI0=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757584277, \"i\": 10}}}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 186964, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:20,809 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 15:21:20,810 [INFO] services.db_service - Bulk upsert complete: Upserted 4, Modified 6
2025-09-11 15:21:20,810 [INFO] __main__ - Upsert Results: {'upserted_count': 4, 'modified_count': 6}
2025-09-11 15:21:20,814 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024333700072020292>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02527600002940744>]>", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}}
2025-09-11 15:21:20,815 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68c29b9222da6da6ad6139f0, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.018859000061638653>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024333700072020292>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02527600002940744>]>", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:20,815 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:20,815 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00024040008429437876}
2025-09-11 15:21:20,816 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "command": "{\"find\": \"emails\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"uUuKQ1k0R2ucshWIDvulag==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757584277, \"i\": 10}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"82Camd1tIJlulfeEyHK+qwwZaI0=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "find", "databaseName": "smart_email_db", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 186964, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:20,859 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "durationMS": 43.452999999999996, "reply": "{\"cursor\": {\"firstBatch\": [{\"provider\": \"gmail\", \"provider_message_id\": \"199374924cbd9c11\", \"created_at\": {\"$date\": \"2025-09-11T06:46:15.035Z\"}, \"fetched_at\": {\"$date\": \"2025-09-11T09:51:20.728Z\"}, \"from\": \"MongoDB Atlas <mongodb-atlas@mongodb.com>\", \"labels\": [\"IMPORTANT\", \"CATEGORY_UPDATES\", \"INBOX\"], \"snippet\": \"ORGANIZATION Rajan&#39;s Org - 2025-09-10 PROJECT Project 0 This is an informational notice to ensure you&#39;re aware that you&#39;ve added &quot;Allow access from anywhere (0.0.0.0/0)&quot; to your\", \"subject\": \"You've added \"Allow access from anywhere (0.0.0.0/0)\" to your Network Permission List\", \"thread_id\": \"199374924cbd9c11\"}, {\"provider_message_id\": \"199374018a3537ad\", \"provider\": \"gmail\", \"created_at\": {\"$date\": \"2025-09-11T06:46:15.035Z\"}, \"fetched_at\": {\"$date\": \"2025-09-11T09:51:20.728Z\"}, \"from\": \"Google <no-reply@accounts.google.com>\", \"labels\": [\"IMPORTANT\", \"CATEGORY_UPDATES\", \"INBOX\"], \"snippet\": \"You allowed Smart Email Assistant access to some of your Go...", "commandName": "find", "databaseName": "smart_email_db", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 186964, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 15:21:20,860 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 15:21:20,860 [INFO] services.db_service - Retrieved 10 emails from MongoDB
2025-09-11 15:21:20,861 [INFO] __main__ - Total stored emails in MongoDB: 10
2025-09-11 15:21:20,978 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 6073.506199987605, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 15:21:20,979 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 6073.832200025208, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 15:21:21,041 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c29b9222da6da6ad6139f0"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 6121.530500007793, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:09:11,081 [INFO] services.db_service - Connecting to MongoDB at mongodb+srv://***:***@cluster0.yrdrirj.mongodb.net/ (db='smart_email_db', collection='emails')
2025-09-11 17:09:11,339 [DEBUG] pymongo.topology - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}}
2025-09-11 17:09:11,340 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "previousDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:09:11,340 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,340 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,340 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,341 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,343 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,345 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,346 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}}
2025-09-11 17:09:11,346 [DEBUG] pymongo.serverSelection - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "remainingTimeMS": 4999}
2025-09-11 17:09:11,502 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:09:11,502 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:09:11,511 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:09:11,526 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "driverConnectionId": 1, "serverConnectionId": 189170, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 24.234100012108684, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"ismaster\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"diskState\": \"READY\", \"provider\": \"AWS\", \"nodeType\": \"ELECTABLE\", \"region\": \"AP_SOUTH_1\", \"availabilityZone\": \"aps1-az3\", \"workloadType\": \"OPERATIONAL\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:39:07Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:39:07Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes..."}
2025-09-11 17:09:11,529 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,530 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "previousDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024234100012108684>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:09:11,530 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024234100012108684>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,531 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,531 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "driverConnectionId": 1, "serverConnectionId": 189170, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:09:11,531 [DEBUG] pymongo.connection - {"message": "Connection created", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:09:11,534 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "driverConnectionId": 1, "serverConnectionId": 181634, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 31.075000064447522, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"diskState\": \"READY\", \"provider\": \"AWS\", \"region\": \"AP_SOUTH_1\", \"availabilityZone\": \"aps1-az1\", \"nodeType\": \"ELECTABLE\", \"workloadType\": \"OPERATIONAL\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:39:07Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:39:07Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:09:11,534 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,534 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "previousDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024234100012108684>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031075000064447522>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024234100012108684>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:09:11,535 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "driverConnectionId": 1, "serverConnectionId": 181634, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:09:11,544 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "driverConnectionId": 1, "serverConnectionId": 179373, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 32.95949997846037, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\", \"region\": \"AP_SOUTH_1\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:39:07Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:39:07Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:09:11,545 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,545 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "previousDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031075000064447522>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024234100012108684>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031075000064447522>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024234100012108684>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03295949997846037>]>"}
2025-09-11 17:09:11,546 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "driverConnectionId": 1, "serverConnectionId": 179373, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:09:11,878 [DEBUG] pymongo.connection - {"message": "Connection ready", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.15937769995070994}
2025-09-11 17:09:11,878 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.34764529997482896}
2025-09-11 17:09:11,878 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "command": "{\"buildinfo\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"7Y2Lk76aTseyconf5qiRQw==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"gwd1wmyK12gIMCSXwAaDrhI9IR8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"admin\"}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189150, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,934 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "durationMS": 55.166, "reply": "{\"version\": \"8.0.13\", \"gitVersion\": \"8dc5cd2a30c4524132e2d44bb314544dc477e611\", \"modules\": [\"enterprise\"], \"allocator\": \"tcmalloc-google\", \"javascriptEngine\": \"mozjs\", \"sysInfo\": \"deprecated\", \"versionArray\": [8, 13], \"bits\": 64, \"maxBsonObjectSize\": 16777216, \"storageEngines\": [\"devnull\", \"inMemory\", \"queryable_wt\", \"wiredTiger\"], \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"gwd1wmyK12gIMCSXwAaDrhI9IR8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189150, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,934 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:09:11,934 [INFO] services.db_service - Connected to MongoDB successfully
2025-09-11 17:09:11,934 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x000001C574AFA200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031075000064447522>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024234100012108684>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03295949997846037>]>", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}}
2025-09-11 17:09:11,935 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x000001C574AFA200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031075000064447522>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024234100012108684>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03295949997846037>]>", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,935 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,935 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0001058999914675951}
2025-09-11 17:09:11,935 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"unique\": true, \"name\": \"provider_msgid_unique\", \"key\": {\"provider\": 1, \"provider_message_id\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"7Y2Lk76aTseyconf5qiRQw==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"gwd1wmyK12gIMCSXwAaDrhI9IR8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189150, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,986 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "durationMS": 50.977000000000004, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"gwd1wmyK12gIMCSXwAaDrhI9IR8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189150, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,986 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:09:11,987 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x000001C574AFA200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031075000064447522>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024234100012108684>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03295949997846037>]>", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}}
2025-09-11 17:09:11,987 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x000001C574AFA200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031075000064447522>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024234100012108684>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03295949997846037>]>", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,987 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:11,987 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00015300000086426735}
2025-09-11 17:09:11,988 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"date_idx\", \"key\": {\"date\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"7Y2Lk76aTseyconf5qiRQw==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"gwd1wmyK12gIMCSXwAaDrhI9IR8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189150, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:12,030 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "durationMS": 42.736999999999995, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"gwd1wmyK12gIMCSXwAaDrhI9IR8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189150, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:12,031 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:09:12,031 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x000001C574AFA200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031075000064447522>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024234100012108684>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03295949997846037>]>", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}}
2025-09-11 17:09:12,031 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x000001C574AFA200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031075000064447522>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024234100012108684>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03295949997846037>]>", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:12,032 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:12,032 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00014789996203035116}
2025-09-11 17:09:12,032 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"from_idx\", \"key\": {\"from\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"7Y2Lk76aTseyconf5qiRQw==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"gwd1wmyK12gIMCSXwAaDrhI9IR8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189150, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:12,073 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "durationMS": 40.497, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"gwd1wmyK12gIMCSXwAaDrhI9IR8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189150, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:12,073 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:09:12,073 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x000001C574AFA200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031075000064447522>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024234100012108684>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03295949997846037>]>", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}}
2025-09-11 17:09:12,073 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x000001C574AFA200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b4df46d0ad4cdf79363f, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031075000064447522>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024234100012108684>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03295949997846037>]>", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:12,074 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:12,074 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00015510001685470343}
2025-09-11 17:09:12,074 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"labels_idx\", \"key\": {\"labels\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"7Y2Lk76aTseyconf5qiRQw==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"gwd1wmyK12gIMCSXwAaDrhI9IR8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189150, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:12,115 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "durationMS": 41.126000000000005, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"gwd1wmyK12gIMCSXwAaDrhI9IR8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757590747, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189150, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:09:12,116 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:09:12,116 [INFO] services.db_service - MongoDB indexes ensured
2025-09-11 17:09:15,602 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 4071.2477000197396, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:09:15,603 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 4068.3264000108466, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:09:15,614 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b4df46d0ad4cdf79363f"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 4068.0093999253586, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:11:01,299 [INFO] services.db_service - Connecting to MongoDB at mongodb+srv://***:***@cluster0.yrdrirj.mongodb.net/ (db='smart_email_db', collection='emails')
2025-09-11 17:11:01,509 [DEBUG] pymongo.topology - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}}
2025-09-11 17:11:01,509 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "previousDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:11:01,509 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,510 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,510 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,510 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,512 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,513 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,514 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}}
2025-09-11 17:11:01,514 [DEBUG] pymongo.serverSelection - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "remainingTimeMS": 4999}
2025-09-11 17:11:01,631 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:11:01,643 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:11:01,650 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:11:01,652 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "driverConnectionId": 1, "serverConnectionId": 189208, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 20.66859998740256, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"ismaster\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"region\": \"AP_SOUTH_1\", \"nodeType\": \"ELECTABLE\", \"availabilityZone\": \"aps1-az3\", \"provider\": \"AWS\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:40:57Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:40:57Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes..."}
2025-09-11 17:11:01,657 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,657 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "previousDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.02066859998740256>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:11:01,658 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.02066859998740256>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,659 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,659 [DEBUG] pymongo.connection - {"message": "Connection created", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:11:01,660 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "driverConnectionId": 1, "serverConnectionId": 189208, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:11:01,666 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "driverConnectionId": 1, "serverConnectionId": 179410, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 22.608799976296723, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\", \"region\": \"AP_SOUTH_1\", \"nodeType\": \"ELECTABLE\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:40:57Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:40:57Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:11:01,667 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,667 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "previousDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.02066859998740256>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.02066859998740256>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.022608799976296723>]>"}
2025-09-11 17:11:01,669 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "driverConnectionId": 1, "serverConnectionId": 179410, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:11:01,674 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "driverConnectionId": 1, "serverConnectionId": 181668, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 23.753699962981045, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"availabilityZone\": \"aps1-az1\", \"provider\": \"AWS\", \"region\": \"AP_SOUTH_1\", \"diskState\": \"READY\", \"workloadType\": \"OPERATIONAL\", \"nodeType\": \"ELECTABLE\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:40:57Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:40:57Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:11:01,675 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,676 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "previousDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.02066859998740256>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.022608799976296723>]>", "newDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.023753699962981045>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.02066859998740256>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.022608799976296723>]>"}
2025-09-11 17:11:01,677 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "driverConnectionId": 1, "serverConnectionId": 181668, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:11:01,916 [DEBUG] pymongo.connection - {"message": "Connection ready", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.1222590000834316}
2025-09-11 17:11:01,916 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.25729340000543743}
2025-09-11 17:11:01,916 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "command": "{\"buildinfo\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/K0T42yQQdiFvmWVY294FA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"w3ukhrPrx7ItiQNKOChGH757Hgw=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"admin\"}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189207, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,946 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "durationMS": 29.860999999999997, "reply": "{\"version\": \"8.0.13\", \"gitVersion\": \"8dc5cd2a30c4524132e2d44bb314544dc477e611\", \"modules\": [\"enterprise\"], \"allocator\": \"tcmalloc-google\", \"javascriptEngine\": \"mozjs\", \"sysInfo\": \"deprecated\", \"versionArray\": [8, 13], \"bits\": 64, \"maxBsonObjectSize\": 16777216, \"storageEngines\": [\"devnull\", \"inMemory\", \"queryable_wt\", \"wiredTiger\"], \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"w3ukhrPrx7ItiQNKOChGH757Hgw=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189207, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,947 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:11:01,948 [INFO] services.db_service - Connected to MongoDB successfully
2025-09-11 17:11:01,949 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x000002AF963BA2A0>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.023753699962981045>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.02066859998740256>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.022608799976296723>]>", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}}
2025-09-11 17:11:01,949 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x000002AF963BA2A0>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.023753699962981045>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.02066859998740256>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.022608799976296723>]>", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,950 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,950 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00035170000046491623}
2025-09-11 17:11:01,951 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"unique\": true, \"name\": \"provider_msgid_unique\", \"key\": {\"provider\": 1, \"provider_message_id\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/K0T42yQQdiFvmWVY294FA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"w3ukhrPrx7ItiQNKOChGH757Hgw=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189207, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,995 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "durationMS": 44.609, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"w3ukhrPrx7ItiQNKOChGH757Hgw=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189207, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,996 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:11:01,996 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x000002AF963BA2A0>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.023753699962981045>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.02066859998740256>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.022608799976296723>]>", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}}
2025-09-11 17:11:01,996 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x000002AF963BA2A0>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.023753699962981045>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.02066859998740256>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.022608799976296723>]>", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,996 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:01,996 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00013020006008446217}
2025-09-11 17:11:01,997 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"date_idx\", \"key\": {\"date\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/K0T42yQQdiFvmWVY294FA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"w3ukhrPrx7ItiQNKOChGH757Hgw=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189207, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:02,036 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "durationMS": 39.428, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"w3ukhrPrx7ItiQNKOChGH757Hgw=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189207, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:02,037 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:11:02,037 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x000002AF963BA2A0>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.023753699962981045>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.02066859998740256>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.022608799976296723>]>", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}}
2025-09-11 17:11:02,037 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x000002AF963BA2A0>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.023753699962981045>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.02066859998740256>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.022608799976296723>]>", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:02,038 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:02,038 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00021439988631755114}
2025-09-11 17:11:02,038 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"from_idx\", \"key\": {\"from\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/K0T42yQQdiFvmWVY294FA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"w3ukhrPrx7ItiQNKOChGH757Hgw=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189207, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:02,076 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "durationMS": 37.935, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"w3ukhrPrx7ItiQNKOChGH757Hgw=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189207, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:02,077 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:11:02,078 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x000002AF963BA2A0>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.023753699962981045>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.02066859998740256>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.022608799976296723>]>", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}}
2025-09-11 17:11:02,078 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x000002AF963BA2A0>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b54d199bf3af70ea5218, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.023753699962981045>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.02066859998740256>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.022608799976296723>]>", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:02,079 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:02,079 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00037809996865689754}
2025-09-11 17:11:02,080 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"labels_idx\", \"key\": {\"labels\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"/K0T42yQQdiFvmWVY294FA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"w3ukhrPrx7ItiQNKOChGH757Hgw=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189207, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:02,121 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "durationMS": 40.548, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"w3ukhrPrx7ItiQNKOChGH757Hgw=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757590857, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189207, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:02,121 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:11:02,122 [INFO] services.db_service - MongoDB indexes ensured
2025-09-11 17:11:03,713 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 2035.8996000140905, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:11:03,714 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 2054.87890006043, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:11:03,716 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b54d199bf3af70ea5218"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 2047.141300048679, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:11:38,105 [INFO] services.db_service - Connecting to MongoDB at mongodb+srv://***:***@cluster0.yrdrirj.mongodb.net/ (db='smart_email_db', collection='emails')
2025-09-11 17:11:38,290 [DEBUG] pymongo.topology - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}}
2025-09-11 17:11:38,291 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "previousDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:11:38,291 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,291 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,291 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,292 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,293 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,295 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,296 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}}
2025-09-11 17:11:38,296 [DEBUG] pymongo.serverSelection - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "remainingTimeMS": 4999}
2025-09-11 17:11:38,402 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:11:38,410 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:11:38,428 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "driverConnectionId": 1, "serverConnectionId": 179423, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 25.429500034078956, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"region\": \"AP_SOUTH_1\", \"workloadType\": \"OPERATIONAL\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\", \"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:41:34Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:41:34Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:11:38,430 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:11:38,434 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,436 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "previousDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>"}
2025-09-11 17:11:38,438 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "driverConnectionId": 1, "serverConnectionId": 189218, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 26.817999896593392, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"ismaster\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"region\": \"AP_SOUTH_1\", \"nodeType\": \"ELECTABLE\", \"availabilityZone\": \"aps1-az3\", \"provider\": \"AWS\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:41:34Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:41:34Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes..."}
2025-09-11 17:11:38,439 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,439 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "previousDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>", "newDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026817999896593392>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>"}
2025-09-11 17:11:38,440 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "driverConnectionId": 1, "serverConnectionId": 179423, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:11:38,440 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "driverConnectionId": 1, "serverConnectionId": 189218, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:11:38,441 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026817999896593392>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,442 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,442 [DEBUG] pymongo.connection - {"message": "Connection created", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:11:38,461 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "driverConnectionId": 1, "serverConnectionId": 181678, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 25.85860004182905, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"diskState\": \"READY\", \"workloadType\": \"OPERATIONAL\", \"nodeType\": \"ELECTABLE\", \"availabilityZone\": \"aps1-az1\", \"region\": \"AP_SOUTH_1\", \"provider\": \"AWS\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:41:34Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:41:34Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:11:38,462 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,462 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "previousDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026817999896593392>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>", "newDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02585860004182905>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026817999896593392>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>"}
2025-09-11 17:11:38,463 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "driverConnectionId": 1, "serverConnectionId": 181678, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:11:38,687 [DEBUG] pymongo.connection - {"message": "Connection ready", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.13835350004956126}
2025-09-11 17:11:38,687 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.24526140000671148}
2025-09-11 17:11:38,688 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "command": "{\"buildinfo\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gkMKp4o6TZyDrvavUKZ4nA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"m4zE5n5/HAXKRzz5yapTgVLVZuU=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"admin\"}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189221, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,712 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "durationMS": 24.012999999999998, "reply": "{\"version\": \"8.0.13\", \"gitVersion\": \"8dc5cd2a30c4524132e2d44bb314544dc477e611\", \"modules\": [\"enterprise\"], \"allocator\": \"tcmalloc-google\", \"javascriptEngine\": \"mozjs\", \"sysInfo\": \"deprecated\", \"versionArray\": [8, 13], \"bits\": 64, \"maxBsonObjectSize\": 16777216, \"storageEngines\": [\"devnull\", \"inMemory\", \"queryable_wt\", \"wiredTiger\"], \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"m4zE5n5/HAXKRzz5yapTgVLVZuU=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189221, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,713 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:11:38,713 [INFO] services.db_service - Connected to MongoDB successfully
2025-09-11 17:11:38,715 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x000001717206A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02585860004182905>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026817999896593392>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}}
2025-09-11 17:11:38,715 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x000001717206A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02585860004182905>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026817999896593392>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,716 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,717 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00042289996054023504}
2025-09-11 17:11:38,717 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"unique\": true, \"name\": \"provider_msgid_unique\", \"key\": {\"provider\": 1, \"provider_message_id\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gkMKp4o6TZyDrvavUKZ4nA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"m4zE5n5/HAXKRzz5yapTgVLVZuU=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189221, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,756 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "durationMS": 38.722, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"m4zE5n5/HAXKRzz5yapTgVLVZuU=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189221, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,757 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:11:38,757 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x000001717206A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02585860004182905>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026817999896593392>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}}
2025-09-11 17:11:38,758 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x000001717206A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02585860004182905>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026817999896593392>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,759 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,760 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0008514999644830823}
2025-09-11 17:11:38,760 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"date_idx\", \"key\": {\"date\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gkMKp4o6TZyDrvavUKZ4nA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"m4zE5n5/HAXKRzz5yapTgVLVZuU=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189221, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,802 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "durationMS": 41.785000000000004, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"m4zE5n5/HAXKRzz5yapTgVLVZuU=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189221, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,802 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:11:38,803 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x000001717206A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02585860004182905>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026817999896593392>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}}
2025-09-11 17:11:38,803 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x000001717206A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02585860004182905>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026817999896593392>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,803 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,803 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0001607999438419938}
2025-09-11 17:11:38,804 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"from_idx\", \"key\": {\"from\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gkMKp4o6TZyDrvavUKZ4nA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"m4zE5n5/HAXKRzz5yapTgVLVZuU=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189221, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,860 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "durationMS": 56.09, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"m4zE5n5/HAXKRzz5yapTgVLVZuU=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189221, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,861 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:11:38,861 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x000001717206A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02585860004182905>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026817999896593392>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}}
2025-09-11 17:11:38,862 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x000001717206A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02585860004182905>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026817999896593392>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,862 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,863 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0003793999785557389}
2025-09-11 17:11:38,863 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"labels_idx\", \"key\": {\"labels\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gkMKp4o6TZyDrvavUKZ4nA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"m4zE5n5/HAXKRzz5yapTgVLVZuU=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189221, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,916 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "durationMS": 52.69, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"m4zE5n5/HAXKRzz5yapTgVLVZuU=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189221, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:38,917 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:11:38,917 [INFO] services.db_service - MongoDB indexes ensured
2025-09-11 17:11:38,941 [INFO] __main__ - Starting Smart Email Assistant Backend
2025-09-11 17:11:38,954 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-11 17:11:38,954 [INFO] services.gmail_service - Refreshing expired Gmail token...
2025-09-11 17:11:38,960 [DEBUG] urllib3.connectionpool - Starting new HTTPS connection (1): oauth2.googleapis.com:443
2025-09-11 17:11:39,313 [DEBUG] urllib3.connectionpool - https://oauth2.googleapis.com:443 "POST /token HTTP/1.1" 200 None
2025-09-11 17:11:39,316 [INFO] services.gmail_service - Token refreshed successfully
2025-09-11 17:11:39,317 [INFO] services.gmail_service - Saved Gmail token.json for future runs
2025-09-11 17:11:39,328 [INFO] googleapiclient.discovery_cache - file_cache is only supported with oauth2client<4.0.0
2025-09-11 17:11:39,336 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-11 17:11:39,336 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-11 17:11:39,336 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-11 17:11:39,344 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?labelIds=INBOX&maxResults=10&alt=json
2025-09-11 17:11:40,230 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/1993797cbb72a9f8?alt=json
2025-09-11 17:11:40,647 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199374924cbd9c11?alt=json
2025-09-11 17:11:41,016 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199374018a3537ad?alt=json
2025-09-11 17:11:41,485 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199372f48f5a3d5a?alt=json
2025-09-11 17:11:41,844 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/1993718a428b45ee?alt=json
2025-09-11 17:11:42,317 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/19936d3d33cfe857?alt=json
2025-09-11 17:11:43,072 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199336433472cb67?alt=json
2025-09-11 17:11:43,588 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199331aaa4dc15d3?alt=json
2025-09-11 17:11:43,951 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/1993319d67463407?alt=json
2025-09-11 17:11:44,326 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199330cea0a5cb8a?alt=json
2025-09-11 17:11:44,664 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-11 17:11:44,664 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-11 17:11:44,665 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-11 17:11:44,666 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x000001717206A200>", "operation": "insert", "operationId": 1947477792, "topologyDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02585860004182905>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026817999896593392>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}}
2025-09-11 17:11:44,667 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x000001717206A200>", "operation": "insert", "operationId": 1947477792, "topologyDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02585860004182905>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026817999896593392>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:44,668 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:44,668 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0004613000201061368}
2025-09-11 17:11:44,670 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "command": "{\"update\": \"emails\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gkMKp4o6TZyDrvavUKZ4nA==\", \"subType\": \"04\"}}}, \"txnNumber\": 1, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590894, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"m4zE5n5/HAXKRzz5yapTgVLVZuU=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\", \"updates\": [{\"q\": {\"provider\": \"gmail\", \"provider_message_id\": \"1993797cbb72a9f8\"}, \"u\": {\"$set\": {\"provider\": \"gmail\", \"provider_message_id\": \"1993797cbb72a9f8\", \"thread_id\": \"1993797cbb72a9f8\", \"from\": \"Rajan Malaviya <rajanmalaviya111@gmail.com>\", \"subject\": \"Test Mail\", \"snippet\": \"This is the testing email. Thanks!!\", \"labels\": [\"IMPORTANT\", \"CATEGORY_PERSONAL\", \"INBOX\"], \"fetched_at\": {\"$date\": \"2025-09-11T11:41:44.665Z\"}}, \"$setOnInsert\": {\"created_at\": {\"$date\": \"2025-09-11T11:41:44.665Z\"}}}, \"upsert\": true}, {\"q\": {\"provider\": \"gmail\", \"provider_message_id\": \"199374924cbd9c11\"}, \"u\": {\"$set\": {\"provider\": \"gmail\", \"provider_message_...", "commandName": "update", "databaseName": "smart_email_db", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 189221, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:44,716 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "durationMS": 47.393, "reply": "{\"n\": 10, \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757590901, \"i\": 10}}, \"t\": 75}, \"nModified\": 10, \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590901, \"i\": 10}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"XQBuJUEz3vRAQP/dQnI2eRe+zQY=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757590901, \"i\": 10}}}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 189221, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:44,717 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:11:44,717 [INFO] services.db_service - Bulk upsert complete: Upserted 0, Modified 10
2025-09-11 17:11:44,717 [INFO] __main__ - Upsert Results: {'upserted_count': 0, 'modified_count': 10}
2025-09-11 17:11:44,721 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02585860004182905>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026817999896593392>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}}
2025-09-11 17:11:44,721 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68c2b57292c6b0804a6e2455, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02585860004182905>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026817999896593392>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.025429500034078956>]>", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:44,722 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:44,722 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00019749999046325684}
2025-09-11 17:11:44,722 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "command": "{\"find\": \"emails\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"gkMKp4o6TZyDrvavUKZ4nA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757590901, \"i\": 10}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"XQBuJUEz3vRAQP/dQnI2eRe+zQY=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "find", "databaseName": "smart_email_db", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 189221, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:44,744 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "durationMS": 21.997, "reply": "{\"cursor\": {\"firstBatch\": [{\"provider\": \"gmail\", \"provider_message_id\": \"199374924cbd9c11\", \"created_at\": {\"$date\": \"2025-09-11T06:46:15.035Z\"}, \"fetched_at\": {\"$date\": \"2025-09-11T11:41:44.665Z\"}, \"from\": \"MongoDB Atlas <mongodb-atlas@mongodb.com>\", \"labels\": [\"IMPORTANT\", \"CATEGORY_UPDATES\", \"INBOX\"], \"snippet\": \"ORGANIZATION Rajan&#39;s Org - 2025-09-10 PROJECT Project 0 This is an informational notice to ensure you&#39;re aware that you&#39;ve added &quot;Allow access from anywhere (0.0.0.0/0)&quot; to your\", \"subject\": \"You've added \"Allow access from anywhere (0.0.0.0/0)\" to your Network Permission List\", \"thread_id\": \"199374924cbd9c11\"}, {\"provider_message_id\": \"199374018a3537ad\", \"provider\": \"gmail\", \"created_at\": {\"$date\": \"2025-09-11T06:46:15.035Z\"}, \"fetched_at\": {\"$date\": \"2025-09-11T11:41:44.665Z\"}, \"from\": \"Google <no-reply@accounts.google.com>\", \"labels\": [\"IMPORTANT\", \"CATEGORY_UPDATES\", \"INBOX\"], \"snippet\": \"You allowed Smart Email Assistant access to some of your Go...", "commandName": "find", "databaseName": "smart_email_db", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 189221, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:11:44,745 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:11:44,745 [INFO] services.db_service - Retrieved 10 emails from MongoDB
2025-09-11 17:11:44,745 [INFO] __main__ - Total stored emails in MongoDB: 10
2025-09-11 17:11:45,015 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 6575.358800007962, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:11:45,016 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 6575.955700012855, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:11:45,030 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b57292c6b0804a6e2455"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 6566.784300026484, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:16:05,644 [INFO] services.db_service - Connecting to MongoDB at mongodb+srv://***:***@cluster0.yrdrirj.mongodb.net/ (db='smart_email_db', collection='emails')
2025-09-11 17:16:05,851 [DEBUG] pymongo.topology - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}}
2025-09-11 17:16:05,852 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "previousDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:16:05,852 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:05,852 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:05,852 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:05,852 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:05,854 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:05,856 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:05,857 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b67d50cee38b22715757"}}
2025-09-11 17:16:05,857 [DEBUG] pymongo.serverSelection - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "remainingTimeMS": 4999}
2025-09-11 17:16:05,976 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:16:05,990 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:16:06,002 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "driverConnectionId": 1, "serverConnectionId": 181758, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 25.23500006645918, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"nodeType\": \"ELECTABLE\", \"region\": \"AP_SOUTH_1\", \"provider\": \"AWS\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"availabilityZone\": \"aps1-az1\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:45:58Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:45:58Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:16:06,005 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,005 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "previousDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02523500006645918>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:16:06,006 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "driverConnectionId": 1, "serverConnectionId": 181758, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:16:06,012 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:16:06,017 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "driverConnectionId": 1, "serverConnectionId": 179501, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 27.325599920004606, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"nodeType\": \"ELECTABLE\", \"region\": \"AP_SOUTH_1\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\", \"diskState\": \"READY\", \"workloadType\": \"OPERATIONAL\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:45:58Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:45:58Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:16:06,018 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,018 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "previousDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02523500006645918>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02523500006645918>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027325599920004606>]>"}
2025-09-11 17:16:06,020 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "driverConnectionId": 1, "serverConnectionId": 179501, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:16:06,037 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "driverConnectionId": 1, "serverConnectionId": 189266, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 24.777299957349896, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"ismaster\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"diskState\": \"READY\", \"workloadType\": \"OPERATIONAL\", \"availabilityZone\": \"aps1-az3\", \"provider\": \"AWS\", \"region\": \"AP_SOUTH_1\", \"nodeType\": \"ELECTABLE\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:45:58Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:45:58Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes..."}
2025-09-11 17:16:06,039 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,039 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "previousDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02523500006645918>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027325599920004606>]>", "newDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02523500006645918>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024777299957349896>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027325599920004606>]>"}
2025-09-11 17:16:06,040 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02523500006645918>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024777299957349896>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027325599920004606>]>", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,041 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,041 [DEBUG] pymongo.connection - {"message": "Connection created", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:16:06,042 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "driverConnectionId": 1, "serverConnectionId": 189266, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:16:06,297 [DEBUG] pymongo.connection - {"message": "Connection ready", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.09629700006917119}
2025-09-11 17:16:06,298 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.25672240008134395}
2025-09-11 17:16:06,298 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "command": "{\"buildinfo\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"CUphC361RW+EPPexwv34jg==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"BW5exDJiVfr8pSj10siIJdYlo2c=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"admin\"}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189300, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,320 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "durationMS": 22.476, "reply": "{\"version\": \"8.0.13\", \"gitVersion\": \"8dc5cd2a30c4524132e2d44bb314544dc477e611\", \"modules\": [\"enterprise\"], \"allocator\": \"tcmalloc-google\", \"javascriptEngine\": \"mozjs\", \"sysInfo\": \"deprecated\", \"versionArray\": [8, 13], \"bits\": 64, \"maxBsonObjectSize\": 16777216, \"storageEngines\": [\"devnull\", \"inMemory\", \"queryable_wt\", \"wiredTiger\"], \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"BW5exDJiVfr8pSj10siIJdYlo2c=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189300, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,321 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:16:06,321 [INFO] services.db_service - Connected to MongoDB successfully
2025-09-11 17:16:06,322 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x00000219480BA200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02523500006645918>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024777299957349896>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027325599920004606>]>", "clientId": {"$oid": "68c2b67d50cee38b22715757"}}
2025-09-11 17:16:06,323 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x00000219480BA200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02523500006645918>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024777299957349896>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027325599920004606>]>", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,323 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,323 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00025399995502084494}
2025-09-11 17:16:06,324 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"unique\": true, \"name\": \"provider_msgid_unique\", \"key\": {\"provider\": 1, \"provider_message_id\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"CUphC361RW+EPPexwv34jg==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"BW5exDJiVfr8pSj10siIJdYlo2c=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189300, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,367 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "durationMS": 43.349, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"BW5exDJiVfr8pSj10siIJdYlo2c=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189300, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,368 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:16:06,368 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x00000219480BA200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02523500006645918>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024777299957349896>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027325599920004606>]>", "clientId": {"$oid": "68c2b67d50cee38b22715757"}}
2025-09-11 17:16:06,368 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x00000219480BA200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02523500006645918>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024777299957349896>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027325599920004606>]>", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,369 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,369 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00016170006711035967}
2025-09-11 17:16:06,369 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"date_idx\", \"key\": {\"date\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"CUphC361RW+EPPexwv34jg==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"BW5exDJiVfr8pSj10siIJdYlo2c=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189300, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,406 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "durationMS": 36.789, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"BW5exDJiVfr8pSj10siIJdYlo2c=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189300, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,407 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:16:06,407 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x00000219480BA200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02523500006645918>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024777299957349896>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027325599920004606>]>", "clientId": {"$oid": "68c2b67d50cee38b22715757"}}
2025-09-11 17:16:06,408 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x00000219480BA200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02523500006645918>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024777299957349896>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027325599920004606>]>", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,409 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,410 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0005040999967604876}
2025-09-11 17:16:06,410 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"from_idx\", \"key\": {\"from\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"CUphC361RW+EPPexwv34jg==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"BW5exDJiVfr8pSj10siIJdYlo2c=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189300, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,449 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "durationMS": 38.818, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"BW5exDJiVfr8pSj10siIJdYlo2c=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189300, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,450 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:16:06,450 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x00000219480BA200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02523500006645918>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024777299957349896>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027325599920004606>]>", "clientId": {"$oid": "68c2b67d50cee38b22715757"}}
2025-09-11 17:16:06,451 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x00000219480BA200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b67d50cee38b22715757, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02523500006645918>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024777299957349896>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027325599920004606>]>", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,451 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,451 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0001962999813258648}
2025-09-11 17:16:06,452 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"labels_idx\", \"key\": {\"labels\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"CUphC361RW+EPPexwv34jg==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"BW5exDJiVfr8pSj10siIJdYlo2c=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189300, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,488 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "durationMS": 36.283, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"BW5exDJiVfr8pSj10siIJdYlo2c=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591158, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189300, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:16:06,488 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:16:06,488 [INFO] services.db_service - MongoDB indexes ensured
2025-09-11 17:16:08,034 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 2027.7198000112548, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:16:08,050 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 2030.1978999050334, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:16:08,082 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b67d50cee38b22715757"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 2040.1791000040248, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:20:02,871 [INFO] services.db_service - Connecting to MongoDB at mongodb+srv://***:***@cluster0.yrdrirj.mongodb.net/ (db='smart_email_db', collection='emails')
2025-09-11 17:20:03,274 [DEBUG] pymongo.topology - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}}
2025-09-11 17:20:03,274 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "previousDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:20:03,275 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,275 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,275 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,276 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,277 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,279 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,280 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}}
2025-09-11 17:20:03,281 [DEBUG] pymongo.serverSelection - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "remainingTimeMS": 4999}
2025-09-11 17:20:03,427 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:20:03,443 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:20:03,463 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "driverConnectionId": 1, "serverConnectionId": 179546, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 34.504399984143674, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"workloadType\": \"OPERATIONAL\", \"region\": \"AP_SOUTH_1\", \"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:49:59Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:49:59Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:20:03,464 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:20:03,480 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "driverConnectionId": 1, "serverConnectionId": 189347, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 37.157699931412935, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"ismaster\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"availabilityZone\": \"aps1-az3\", \"nodeType\": \"ELECTABLE\", \"provider\": \"AWS\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"region\": \"AP_SOUTH_1\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:49:59Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:49:59Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes..."}
2025-09-11 17:20:03,484 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,485 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "previousDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>"}
2025-09-11 17:20:03,486 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,486 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "previousDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>", "newDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.037157699931412935>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>"}
2025-09-11 17:20:03,486 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.037157699931412935>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,487 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,487 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "driverConnectionId": 1, "serverConnectionId": 179546, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:20:03,487 [DEBUG] pymongo.connection - {"message": "Connection created", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:20:03,488 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "driverConnectionId": 1, "serverConnectionId": 189347, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:20:03,513 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "driverConnectionId": 1, "serverConnectionId": 181805, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 28.573499992489815, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"diskState\": \"READY\", \"provider\": \"AWS\", \"region\": \"AP_SOUTH_1\", \"availabilityZone\": \"aps1-az1\", \"nodeType\": \"ELECTABLE\", \"workloadType\": \"OPERATIONAL\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:49:59Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:49:59Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:20:03,514 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,514 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "previousDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.037157699931412935>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>", "newDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028573499992489815>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.037157699931412935>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>"}
2025-09-11 17:20:03,515 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "driverConnectionId": 1, "serverConnectionId": 181805, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:20:03,695 [DEBUG] pymongo.connection - {"message": "Connection ready", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.09270220005419105}
2025-09-11 17:20:03,696 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.20882050006184727}
2025-09-11 17:20:03,696 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "command": "{\"buildinfo\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"FdpAKQLoTvG4Ip2Yt9drOA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"asnHC2w0I0eJVFM2tq73tD+H3/U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"admin\"}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189348, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,729 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "durationMS": 33.564, "reply": "{\"version\": \"8.0.13\", \"gitVersion\": \"8dc5cd2a30c4524132e2d44bb314544dc477e611\", \"modules\": [\"enterprise\"], \"allocator\": \"tcmalloc-google\", \"javascriptEngine\": \"mozjs\", \"sysInfo\": \"deprecated\", \"versionArray\": [8, 13], \"bits\": 64, \"maxBsonObjectSize\": 16777216, \"storageEngines\": [\"devnull\", \"inMemory\", \"queryable_wt\", \"wiredTiger\"], \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"asnHC2w0I0eJVFM2tq73tD+H3/U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189348, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,730 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:20:03,730 [INFO] services.db_service - Connected to MongoDB successfully
2025-09-11 17:20:03,730 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000024245BFE200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028573499992489815>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.037157699931412935>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}}
2025-09-11 17:20:03,730 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000024245BFE200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028573499992489815>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.037157699931412935>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,731 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,731 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 9.349989704787731e-05}
2025-09-11 17:20:03,731 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"unique\": true, \"name\": \"provider_msgid_unique\", \"key\": {\"provider\": 1, \"provider_message_id\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"FdpAKQLoTvG4Ip2Yt9drOA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"asnHC2w0I0eJVFM2tq73tD+H3/U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189348, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,781 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "durationMS": 49.768, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"asnHC2w0I0eJVFM2tq73tD+H3/U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189348, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,781 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:20:03,781 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000024245BFE200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028573499992489815>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.037157699931412935>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}}
2025-09-11 17:20:03,781 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000024245BFE200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028573499992489815>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.037157699931412935>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,781 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,782 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 9.34000127017498e-05}
2025-09-11 17:20:03,782 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"date_idx\", \"key\": {\"date\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"FdpAKQLoTvG4Ip2Yt9drOA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"asnHC2w0I0eJVFM2tq73tD+H3/U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189348, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,820 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "durationMS": 38.122, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"asnHC2w0I0eJVFM2tq73tD+H3/U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189348, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,820 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:20:03,820 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000024245BFE200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028573499992489815>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.037157699931412935>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}}
2025-09-11 17:20:03,821 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000024245BFE200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028573499992489815>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.037157699931412935>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,821 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,821 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 8.869997691363096e-05}
2025-09-11 17:20:03,821 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"from_idx\", \"key\": {\"from\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"FdpAKQLoTvG4Ip2Yt9drOA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"asnHC2w0I0eJVFM2tq73tD+H3/U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189348, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,860 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "durationMS": 38.730000000000004, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"asnHC2w0I0eJVFM2tq73tD+H3/U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189348, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,860 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:20:03,860 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000024245BFE200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028573499992489815>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.037157699931412935>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}}
2025-09-11 17:20:03,860 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000024245BFE200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028573499992489815>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.037157699931412935>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,861 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,861 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00011170003563165665}
2025-09-11 17:20:03,861 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"labels_idx\", \"key\": {\"labels\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"FdpAKQLoTvG4Ip2Yt9drOA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"asnHC2w0I0eJVFM2tq73tD+H3/U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189348, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,899 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "durationMS": 38.373999999999995, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"asnHC2w0I0eJVFM2tq73tD+H3/U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189348, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:03,900 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:20:03,900 [INFO] services.db_service - MongoDB indexes ensured
2025-09-11 17:20:05,483 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-11 17:20:05,486 [INFO] googleapiclient.discovery_cache - file_cache is only supported with oauth2client<4.0.0
2025-09-11 17:20:05,512 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-11 17:20:05,512 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-11 17:20:05,512 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-11 17:20:05,515 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?labelIds=INBOX&maxResults=10&alt=json
2025-09-11 17:20:06,389 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/1993797cbb72a9f8?alt=json
2025-09-11 17:20:06,751 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199374924cbd9c11?alt=json
2025-09-11 17:20:07,127 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199374018a3537ad?alt=json
2025-09-11 17:20:07,499 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199372f48f5a3d5a?alt=json
2025-09-11 17:20:07,874 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/1993718a428b45ee?alt=json
2025-09-11 17:20:08,246 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/19936d3d33cfe857?alt=json
2025-09-11 17:20:08,758 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199336433472cb67?alt=json
2025-09-11 17:20:09,107 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199331aaa4dc15d3?alt=json
2025-09-11 17:20:09,510 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/1993319d67463407?alt=json
2025-09-11 17:20:09,961 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199330cea0a5cb8a?alt=json
2025-09-11 17:20:10,315 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-11 17:20:10,315 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-11 17:20:10,315 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-11 17:20:10,316 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000024245BFE200>", "operation": "insert", "operationId": -725811881, "topologyDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028573499992489815>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.037157699931412935>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}}
2025-09-11 17:20:10,316 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000024245BFE200>", "operation": "insert", "operationId": -725811881, "topologyDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028573499992489815>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.037157699931412935>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:10,316 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:10,316 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00012649991549551487}
2025-09-11 17:20:10,317 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "command": "{\"update\": \"emails\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"FdpAKQLoTvG4Ip2Yt9drOA==\", \"subType\": \"04\"}}}, \"txnNumber\": 1, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591399, \"i\": 2}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"asnHC2w0I0eJVFM2tq73tD+H3/U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\", \"updates\": [{\"q\": {\"provider\": \"gmail\", \"provider_message_id\": \"1993797cbb72a9f8\"}, \"u\": {\"$set\": {\"provider\": \"gmail\", \"provider_message_id\": \"1993797cbb72a9f8\", \"thread_id\": \"1993797cbb72a9f8\", \"from\": \"Rajan Malaviya <rajanmalaviya111@gmail.com>\", \"subject\": \"Test Mail\", \"snippet\": \"This is the testing email. Thanks!!\", \"labels\": [\"IMPORTANT\", \"CATEGORY_PERSONAL\", \"INBOX\"], \"fetched_at\": {\"$date\": \"2025-09-11T11:50:10.315Z\"}}, \"$setOnInsert\": {\"created_at\": {\"$date\": \"2025-09-11T11:50:10.315Z\"}}}, \"upsert\": true}, {\"q\": {\"provider\": \"gmail\", \"provider_message_id\": \"199374924cbd9c11\"}, \"u\": {\"$set\": {\"provider\": \"gmail\", \"provider_message_...", "commandName": "update", "databaseName": "smart_email_db", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 189348, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:10,357 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "durationMS": 40.669, "reply": "{\"n\": 10, \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591406, \"i\": 10}}, \"t\": 75}, \"nModified\": 10, \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591406, \"i\": 10}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"VFLLOxhzhfZJbX9keob/ruCes4Y=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591406, \"i\": 10}}}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 189348, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:10,357 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:20:10,358 [INFO] services.db_service - Bulk upsert complete: Upserted 0, Modified 10
2025-09-11 17:20:10,358 [INFO] __main__ - Upsert Results: {'upserted_count': 0, 'modified_count': 10}
2025-09-11 17:20:10,359 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028573499992489815>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.037157699931412935>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}}
2025-09-11 17:20:10,359 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68c2b76a8cc0183a64269d65, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028573499992489815>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.037157699931412935>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.034504399984143674>]>", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:10,360 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:10,360 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00012700003571808338}
2025-09-11 17:20:10,360 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "command": "{\"find\": \"emails\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"FdpAKQLoTvG4Ip2Yt9drOA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591406, \"i\": 10}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"VFLLOxhzhfZJbX9keob/ruCes4Y=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "find", "databaseName": "smart_email_db", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 189348, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:10,383 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "durationMS": 23.005000000000003, "reply": "{\"cursor\": {\"firstBatch\": [{\"provider\": \"gmail\", \"provider_message_id\": \"199374924cbd9c11\", \"created_at\": {\"$date\": \"2025-09-11T06:46:15.035Z\"}, \"fetched_at\": {\"$date\": \"2025-09-11T11:50:10.315Z\"}, \"from\": \"MongoDB Atlas <mongodb-atlas@mongodb.com>\", \"labels\": [\"IMPORTANT\", \"CATEGORY_UPDATES\", \"INBOX\"], \"snippet\": \"ORGANIZATION Rajan&#39;s Org - 2025-09-10 PROJECT Project 0 This is an informational notice to ensure you&#39;re aware that you&#39;ve added &quot;Allow access from anywhere (0.0.0.0/0)&quot; to your\", \"subject\": \"You've added \"Allow access from anywhere (0.0.0.0/0)\" to your Network Permission List\", \"thread_id\": \"199374924cbd9c11\"}, {\"provider_message_id\": \"199374018a3537ad\", \"provider\": \"gmail\", \"created_at\": {\"$date\": \"2025-09-11T06:46:15.035Z\"}, \"fetched_at\": {\"$date\": \"2025-09-11T11:50:10.315Z\"}, \"from\": \"Google <no-reply@accounts.google.com>\", \"labels\": [\"IMPORTANT\", \"CATEGORY_UPDATES\", \"INBOX\"], \"snippet\": \"You allowed Smart Email Assistant access to some of your Go...", "commandName": "find", "databaseName": "smart_email_db", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 189348, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:10,383 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:20:10,384 [INFO] services.db_service - Retrieved 10 emails from MongoDB
2025-09-11 17:20:10,384 [INFO] __main__ - Total stored emails in MongoDB: 10
2025-09-11 17:20:10,586 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 7097.808499936946, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:20:10,587 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 7099.4557000231, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:20:10,603 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b76a8cc0183a64269d65"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 7088.212999980897, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:20:50,648 [INFO] services.db_service - Connecting to MongoDB at mongodb+srv://***:***@cluster0.yrdrirj.mongodb.net/ (db='smart_email_db', collection='emails')
2025-09-11 17:20:50,875 [DEBUG] pymongo.topology - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}}
2025-09-11 17:20:50,876 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "previousDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:20:50,876 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:50,876 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:50,876 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:50,876 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:50,878 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:50,880 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:50,881 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}}
2025-09-11 17:20:50,882 [DEBUG] pymongo.serverSelection - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "remainingTimeMS": 4999}
2025-09-11 17:20:50,982 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:20:50,997 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:20:51,006 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 181817, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 23.85220001451671, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"availabilityZone\": \"aps1-az1\", \"provider\": \"AWS\", \"region\": \"AP_SOUTH_1\", \"diskState\": \"READY\", \"workloadType\": \"OPERATIONAL\", \"nodeType\": \"ELECTABLE\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591446, \"i\": 2}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:50:46Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591446, \"i\": 2}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:50:46Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:20:51,009 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,009 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "previousDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02385220001451671>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:20:51,010 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:20:51,010 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 181817, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:20:51,022 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 179558, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 24.121399968862534, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\", \"region\": \"AP_SOUTH_1\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591446, \"i\": 2}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:50:46Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591446, \"i\": 2}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:50:46Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:20:51,022 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,022 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "previousDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02385220001451671>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02385220001451671>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.024121399968862534>]>"}
2025-09-11 17:20:51,023 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 179558, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:20:51,036 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 189361, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 26.153999962843955, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"ismaster\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"region\": \"AP_SOUTH_1\", \"availabilityZone\": \"aps1-az3\", \"workloadType\": \"OPERATIONAL\", \"provider\": \"AWS\", \"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591446, \"i\": 2}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:50:46Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591446, \"i\": 2}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:50:46Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes..."}
2025-09-11 17:20:51,037 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,037 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "previousDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02385220001451671>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.024121399968862534>]>", "newDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02385220001451671>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026153999962843955>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.024121399968862534>]>"}
2025-09-11 17:20:51,037 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02385220001451671>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026153999962843955>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.024121399968862534>]>", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,038 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 189361, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:20:51,038 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,039 [DEBUG] pymongo.connection - {"message": "Connection created", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:20:51,290 [DEBUG] pymongo.connection - {"message": "Connection ready", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.12776939989998937}
2025-09-11 17:20:51,291 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.25274779996834695}
2025-09-11 17:20:51,291 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "command": "{\"buildinfo\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"8GR6SdhYSIO7ZJGQkAIfIg==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591447, \"i\": 62}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"RIUAIienb3Q8SMgCvIV6Vylhc3U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"admin\"}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189365, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,327 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "durationMS": 36.312999999999995, "reply": "{\"version\": \"8.0.13\", \"gitVersion\": \"8dc5cd2a30c4524132e2d44bb314544dc477e611\", \"modules\": [\"enterprise\"], \"allocator\": \"tcmalloc-google\", \"javascriptEngine\": \"mozjs\", \"sysInfo\": \"deprecated\", \"versionArray\": [8, 13], \"bits\": 64, \"maxBsonObjectSize\": 16777216, \"storageEngines\": [\"devnull\", \"inMemory\", \"queryable_wt\", \"wiredTiger\"], \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591447, \"i\": 62}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"RIUAIienb3Q8SMgCvIV6Vylhc3U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591447, \"i\": 62}}}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189365, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,328 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:20:51,329 [INFO] services.db_service - Connected to MongoDB successfully
2025-09-11 17:20:51,330 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x00000209E698E200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02385220001451671>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026153999962843955>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.024121399968862534>]>", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}}
2025-09-11 17:20:51,331 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x00000209E698E200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02385220001451671>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026153999962843955>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.024121399968862534>]>", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,332 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,333 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0005839000223204494}
2025-09-11 17:20:51,334 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"unique\": true, \"name\": \"provider_msgid_unique\", \"key\": {\"provider\": 1, \"provider_message_id\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"8GR6SdhYSIO7ZJGQkAIfIg==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591447, \"i\": 62}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"RIUAIienb3Q8SMgCvIV6Vylhc3U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189365, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,382 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "durationMS": 48.467000000000006, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591447, \"i\": 62}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"RIUAIienb3Q8SMgCvIV6Vylhc3U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591447, \"i\": 62}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189365, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,382 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:20:51,382 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x00000209E698E200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02385220001451671>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026153999962843955>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.024121399968862534>]>", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}}
2025-09-11 17:20:51,383 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x00000209E698E200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02385220001451671>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026153999962843955>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.024121399968862534>]>", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,383 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,383 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00016609998419880867}
2025-09-11 17:20:51,383 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"date_idx\", \"key\": {\"date\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"8GR6SdhYSIO7ZJGQkAIfIg==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591447, \"i\": 62}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"RIUAIienb3Q8SMgCvIV6Vylhc3U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189365, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,429 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "durationMS": 45.445, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591447, \"i\": 62}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"RIUAIienb3Q8SMgCvIV6Vylhc3U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591447, \"i\": 62}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189365, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,429 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:20:51,429 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x00000209E698E200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02385220001451671>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026153999962843955>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.024121399968862534>]>", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}}
2025-09-11 17:20:51,429 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x00000209E698E200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02385220001451671>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026153999962843955>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.024121399968862534>]>", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,430 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,430 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0001463999506086111}
2025-09-11 17:20:51,430 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"from_idx\", \"key\": {\"from\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"8GR6SdhYSIO7ZJGQkAIfIg==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591447, \"i\": 62}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"RIUAIienb3Q8SMgCvIV6Vylhc3U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189365, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,483 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "durationMS": 52.356, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591447, \"i\": 62}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"RIUAIienb3Q8SMgCvIV6Vylhc3U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591447, \"i\": 62}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189365, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,483 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:20:51,484 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x00000209E698E200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02385220001451671>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026153999962843955>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.024121399968862534>]>", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}}
2025-09-11 17:20:51,485 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x00000209E698E200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02385220001451671>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026153999962843955>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.024121399968862534>]>", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,485 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,486 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00038410001434385777}
2025-09-11 17:20:51,487 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"labels_idx\", \"key\": {\"labels\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"8GR6SdhYSIO7ZJGQkAIfIg==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591447, \"i\": 62}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"RIUAIienb3Q8SMgCvIV6Vylhc3U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189365, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,534 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "durationMS": 47.521, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591447, \"i\": 62}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"RIUAIienb3Q8SMgCvIV6Vylhc3U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591447, \"i\": 62}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189365, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:51,535 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:20:51,536 [INFO] services.db_service - MongoDB indexes ensured
2025-09-11 17:20:52,785 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02385220001451671>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026153999962843955>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.024121399968862534>]>", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}}
2025-09-11 17:20:52,786 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02385220001451671>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.026153999962843955>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.024121399968862534>]>", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:52,786 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:52,786 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0001395998988300562}
2025-09-11 17:20:52,786 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "command": "{\"find\": \"emails\", \"sort\": {\"date\": -1}, \"limit\": 10, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"8GR6SdhYSIO7ZJGQkAIfIg==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591447, \"i\": 62}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"RIUAIienb3Q8SMgCvIV6Vylhc3U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "find", "databaseName": "smart_email_db", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 189365, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:52,822 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "durationMS": 35.964999999999996, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68c29b952c6f45e31c3c8e92\"}, \"provider_message_id\": \"199330cea0a5cb8a\", \"provider\": \"gmail\", \"created_at\": {\"$date\": \"2025-09-11T09:51:20.728Z\"}, \"fetched_at\": {\"$date\": \"2025-09-11T11:50:10.315Z\"}, \"from\": \"ChatUML <hello@chatuml.com>\", \"labels\": [\"IMPORTANT\", \"CATEGORY_PERSONAL\", \"INBOX\"], \"snippet\": \"\ud83c\udf89 Welcome to ChatUML! Thank you for joining ChatUML! We are grateful to have you as a part of our community. Please click the link below to finish your account creation. Confirm Email If the button\", \"subject\": \"\ud83c\udf89 Welcome to ChatUML\", \"thread_id\": \"1993308e22a9af2e\"}, {\"_id\": {\"$oid\": \"68c29b952c6f45e31c3c8e91\"}, \"provider\": \"gmail\", \"provider_message_id\": \"1993319d67463407\", \"created_at\": {\"$date\": \"2025-09-11T09:51:20.728Z\"}, \"fetched_at\": {\"$date\": \"2025-09-11T11:50:10.315Z\"}, \"from\": \"The Miro Team <your@product.miro.com>\", \"labels\": [\"IMPORTANT\", \"CATEGORY_UPDATES\", \"INBOX\"], \"snippet\": \"Get started in three simple s...", "commandName": "find", "databaseName": "smart_email_db", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 189365, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:20:52,823 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:20:52,823 [INFO] services.db_service - Fetched 10 unclassified emails from MongoDB
2025-09-11 17:21:01,032 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 181817, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10020.851500099525, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"diskState\": \"READY\", \"provider\": \"AWS\", \"region\": \"AP_SOUTH_1\", \"availabilityZone\": \"aps1-az1\", \"nodeType\": \"ELECTABLE\", \"workloadType\": \"OPERATIONAL\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591456, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:50:56Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591456, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:50:56Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:21:01,034 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 181817, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:21:01,054 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 179558, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10030.885300016962, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"workloadType\": \"OPERATIONAL\", \"region\": \"AP_SOUTH_1\", \"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591456, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:50:56Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591456, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:50:56Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:21:01,055 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 179558, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:21:01,069 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 189361, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10030.440600006841, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"isWritablePrimary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"availabilityZone\": \"aps1-az3\", \"nodeType\": \"ELECTABLE\", \"provider\": \"AWS\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"region\": \"AP_SOUTH_1\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591456, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:50:56Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591456, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:50:56Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000..."}
2025-09-11 17:21:01,069 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 189361, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:21:11,042 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 181817, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10007.283900049515, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"diskState\": \"READY\", \"workloadType\": \"OPERATIONAL\", \"nodeType\": \"ELECTABLE\", \"availabilityZone\": \"aps1-az1\", \"region\": \"AP_SOUTH_1\", \"provider\": \"AWS\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591467, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:51:07Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591467, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:51:07Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:21:11,043 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 181817, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:21:11,062 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 179558, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10006.581499939784, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"nodeType\": \"ELECTABLE\", \"region\": \"AP_SOUTH_1\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\", \"diskState\": \"READY\", \"workloadType\": \"OPERATIONAL\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591467, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:51:07Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591467, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:51:07Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:21:11,064 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 179558, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:21:11,077 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 189361, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10007.555600022897, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"isWritablePrimary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"workloadType\": \"OPERATIONAL\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az3\", \"nodeType\": \"ELECTABLE\", \"region\": \"AP_SOUTH_1\", \"diskState\": \"READY\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591467, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:51:07Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591467, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:51:07Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000..."}
2025-09-11 17:21:11,079 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 189361, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:21:21,055 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 181817, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10010.791999986395, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"workloadType\": \"OPERATIONAL\", \"provider\": \"AWS\", \"region\": \"AP_SOUTH_1\", \"nodeType\": \"ELECTABLE\", \"availabilityZone\": \"aps1-az1\", \"diskState\": \"READY\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591477, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:51:17Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591477, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:51:17Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:21:21,057 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 181817, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:21:21,073 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 179558, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10009.07080003526, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"nodeType\": \"ELECTABLE\", \"region\": \"AP_SOUTH_1\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\", \"diskState\": \"READY\", \"workloadType\": \"OPERATIONAL\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591477, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:51:17Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591477, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:51:17Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:21:21,075 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 179558, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:21:21,079 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 189361, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 9999.76020003669, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"isWritablePrimary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"diskState\": \"READY\", \"workloadType\": \"OPERATIONAL\", \"availabilityZone\": \"aps1-az3\", \"provider\": \"AWS\", \"region\": \"AP_SOUTH_1\", \"nodeType\": \"ELECTABLE\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591477, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:51:17Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591477, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:51:17Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000..."}
2025-09-11 17:21:21,081 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 189361, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:21:31,063 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 181817, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10005.447900039144, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"workloadType\": \"OPERATIONAL\", \"provider\": \"AWS\", \"region\": \"AP_SOUTH_1\", \"nodeType\": \"ELECTABLE\", \"availabilityZone\": \"aps1-az1\", \"diskState\": \"READY\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591486, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:51:26Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591486, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:51:26Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:21:31,064 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 181817, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:21:31,082 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 179558, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10005.840500001796, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"diskState\": \"READY\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\", \"region\": \"AP_SOUTH_1\", \"workloadType\": \"OPERATIONAL\", \"nodeType\": \"ELECTABLE\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591486, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:51:26Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591486, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:51:26Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:21:31,083 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 179558, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:21:31,091 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 189361, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10009.940799907781, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"isWritablePrimary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"availabilityZone\": \"aps1-az3\", \"region\": \"AP_SOUTH_1\", \"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\", \"workloadType\": \"OPERATIONAL\", \"provider\": \"AWS\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591486, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:51:26Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591486, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:51:26Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000..."}
2025-09-11 17:21:31,093 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 189361, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:21:41,061 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 181817, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 9996.74239999149, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"availabilityZone\": \"aps1-az1\", \"nodeType\": \"ELECTABLE\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"region\": \"AP_SOUTH_1\", \"provider\": \"AWS\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591496, \"i\": 3}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:51:36Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591496, \"i\": 3}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:51:36Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:21:41,062 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 181817, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:21:41,092 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 179558, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10009.271499933675, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\", \"region\": \"AP_SOUTH_1\", \"nodeType\": \"ELECTABLE\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591496, \"i\": 3}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:51:36Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591496, \"i\": 3}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:51:36Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:21:41,093 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 179558, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:21:41,098 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 189361, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10005.023599951528, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"isWritablePrimary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"availabilityZone\": \"aps1-az3\", \"region\": \"AP_SOUTH_1\", \"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\", \"workloadType\": \"OPERATIONAL\", \"provider\": \"AWS\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591496, \"i\": 3}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:51:36Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591496, \"i\": 3}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:51:36Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000..."}
2025-09-11 17:21:41,099 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "driverConnectionId": 1, "serverConnectionId": 189361, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:21:46,220 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x00000209E698E200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02913646880701185>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.03360969038818032>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02188390897992999>]>", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}}
2025-09-11 17:21:46,221 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x00000209E698E200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b79a7f5a3b0ad1ed01bb, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02913646880701185>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.03360969038818032>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.02188390897992999>]>", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:21:46,221 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:21:46,222 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0003853000234812498}
2025-09-11 17:21:46,222 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "command": "{\"update\": \"emails\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"8GR6SdhYSIO7ZJGQkAIfIg==\", \"subType\": \"04\"}}}, \"txnNumber\": 1, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591448, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"qI/ArCswm6XrMY9NRPyd5/k+2hg=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\", \"updates\": [{\"q\": {\"_id\": {\"$oid\": \"68c29b952c6f45e31c3c8e92\"}}, \"u\": {\"$set\": {\"classifications.category\": \"Notifications / Updates\", \"classifications.classified_at\": {\"$date\": \"2025-09-11T11:51:46.220Z\"}}}}]}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 189365, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:21:46,262 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "durationMS": 39.494, "reply": "{\"n\": 1, \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591502, \"i\": 3}}, \"t\": 75}, \"nModified\": 1, \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591502, \"i\": 3}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"e+XXCNkkcJB2X0lVtHMXxzGVzdg=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591502, \"i\": 3}}}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 189365, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:21:46,262 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:21:46,645 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 5582.190599991009, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:21:46,660 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 5567.091999924742, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:21:46,661 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b79a7f5a3b0ad1ed01bb"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 5562.179400003515, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:26:14,728 [INFO] services.db_service - Connecting to MongoDB at mongodb+srv://***:***@cluster0.yrdrirj.mongodb.net/ (db='smart_email_db', collection='emails')
2025-09-11 17:26:14,934 [DEBUG] pymongo.topology - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}}
2025-09-11 17:26:14,934 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "previousDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:26:14,934 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:14,934 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:14,934 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:14,935 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:14,937 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:14,939 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:14,940 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}}
2025-09-11 17:26:14,940 [DEBUG] pymongo.serverSelection - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "remainingTimeMS": 4999}
2025-09-11 17:26:15,083 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:26:15,098 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:26:15,111 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "driverConnectionId": 1, "serverConnectionId": 189425, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 27.464799932204187, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"ismaster\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"workloadType\": \"OPERATIONAL\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az3\", \"nodeType\": \"ELECTABLE\", \"region\": \"AP_SOUTH_1\", \"diskState\": \"READY\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:56:09Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:56:09Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes..."}
2025-09-11 17:26:15,113 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,113 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "previousDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.027464799932204187>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:26:15,113 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.027464799932204187>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,114 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,114 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "driverConnectionId": 1, "serverConnectionId": 189425, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:26:15,114 [DEBUG] pymongo.connection - {"message": "Connection created", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:26:15,131 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "driverConnectionId": 1, "serverConnectionId": 179626, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 31.583899981342256, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\", \"region\": \"AP_SOUTH_1\", \"nodeType\": \"ELECTABLE\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:56:09Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:56:09Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:26:15,131 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,131 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "previousDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.027464799932204187>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.027464799932204187>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031583899981342256>]>"}
2025-09-11 17:26:15,132 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "driverConnectionId": 1, "serverConnectionId": 179626, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:26:15,140 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:26:15,169 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "driverConnectionId": 1, "serverConnectionId": 181886, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 28.067999985069036, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"diskState\": \"READY\", \"workloadType\": \"OPERATIONAL\", \"nodeType\": \"ELECTABLE\", \"availabilityZone\": \"aps1-az1\", \"region\": \"AP_SOUTH_1\", \"provider\": \"AWS\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T11:56:09Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T11:56:09Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:26:15,169 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,169 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "previousDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.027464799932204187>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031583899981342256>]>", "newDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028067999985069036>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.027464799932204187>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031583899981342256>]>"}
2025-09-11 17:26:15,170 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "driverConnectionId": 1, "serverConnectionId": 181886, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:26:15,316 [DEBUG] pymongo.connection - {"message": "Connection ready", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.09468170010950416}
2025-09-11 17:26:15,317 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.20287469995673746}
2025-09-11 17:26:15,317 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "command": "{\"buildinfo\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"VB/UzC74RyeL9IsVfhI71A==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"HaIE+6TjdoZ8hfjlS1p+2vsQfH8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"admin\"}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189419, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,341 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "durationMS": 23.548, "reply": "{\"version\": \"8.0.13\", \"gitVersion\": \"8dc5cd2a30c4524132e2d44bb314544dc477e611\", \"modules\": [\"enterprise\"], \"allocator\": \"tcmalloc-google\", \"javascriptEngine\": \"mozjs\", \"sysInfo\": \"deprecated\", \"versionArray\": [8, 13], \"bits\": 64, \"maxBsonObjectSize\": 16777216, \"storageEngines\": [\"devnull\", \"inMemory\", \"queryable_wt\", \"wiredTiger\"], \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"HaIE+6TjdoZ8hfjlS1p+2vsQfH8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189419, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,341 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:26:15,342 [INFO] services.db_service - Connected to MongoDB successfully
2025-09-11 17:26:15,342 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000020325B4E200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028067999985069036>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.027464799932204187>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031583899981342256>]>", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}}
2025-09-11 17:26:15,343 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000020325B4E200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028067999985069036>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.027464799932204187>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031583899981342256>]>", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,343 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,344 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00024720001965761185}
2025-09-11 17:26:15,344 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"unique\": true, \"name\": \"provider_msgid_unique\", \"key\": {\"provider\": 1, \"provider_message_id\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"VB/UzC74RyeL9IsVfhI71A==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"HaIE+6TjdoZ8hfjlS1p+2vsQfH8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189419, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,381 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "durationMS": 36.657000000000004, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"HaIE+6TjdoZ8hfjlS1p+2vsQfH8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189419, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,381 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:26:15,381 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000020325B4E200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028067999985069036>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.027464799932204187>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031583899981342256>]>", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}}
2025-09-11 17:26:15,381 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000020325B4E200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028067999985069036>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.027464799932204187>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031583899981342256>]>", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,382 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,382 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00010840001050382853}
2025-09-11 17:26:15,382 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"date_idx\", \"key\": {\"date\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"VB/UzC74RyeL9IsVfhI71A==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"HaIE+6TjdoZ8hfjlS1p+2vsQfH8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189419, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,416 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "durationMS": 33.723000000000006, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"HaIE+6TjdoZ8hfjlS1p+2vsQfH8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189419, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,416 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:26:15,416 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000020325B4E200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028067999985069036>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.027464799932204187>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031583899981342256>]>", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}}
2025-09-11 17:26:15,416 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000020325B4E200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028067999985069036>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.027464799932204187>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031583899981342256>]>", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,416 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,417 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0001140000531449914}
2025-09-11 17:26:15,417 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"from_idx\", \"key\": {\"from\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"VB/UzC74RyeL9IsVfhI71A==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"HaIE+6TjdoZ8hfjlS1p+2vsQfH8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189419, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,453 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "durationMS": 36.214999999999996, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"HaIE+6TjdoZ8hfjlS1p+2vsQfH8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189419, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,453 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:26:15,454 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000020325B4E200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028067999985069036>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.027464799932204187>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031583899981342256>]>", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}}
2025-09-11 17:26:15,454 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000020325B4E200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028067999985069036>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.027464799932204187>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031583899981342256>]>", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,454 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,454 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00014329992700368166}
2025-09-11 17:26:15,454 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"labels_idx\", \"key\": {\"labels\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"VB/UzC74RyeL9IsVfhI71A==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"HaIE+6TjdoZ8hfjlS1p+2vsQfH8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189419, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,486 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "durationMS": 31.753999999999998, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"HaIE+6TjdoZ8hfjlS1p+2vsQfH8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189419, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:15,487 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:26:15,487 [INFO] services.db_service - MongoDB indexes ensured
2025-09-11 17:26:16,992 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028067999985069036>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.027464799932204187>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031583899981342256>]>", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}}
2025-09-11 17:26:16,992 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68c2b8de34050fdb552674a8, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.028067999985069036>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.027464799932204187>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.031583899981342256>]>", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:16,993 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:16,993 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00013040006160736084}
2025-09-11 17:26:16,993 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "command": "{\"find\": \"emails\", \"sort\": {\"date\": -1}, \"limit\": 10, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"VB/UzC74RyeL9IsVfhI71A==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757591769, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"HaIE+6TjdoZ8hfjlS1p+2vsQfH8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "find", "databaseName": "smart_email_db", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 189419, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:17,017 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "durationMS": 24.242, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68c29b952c6f45e31c3c8e91\"}, \"provider\": \"gmail\", \"provider_message_id\": \"1993319d67463407\", \"created_at\": {\"$date\": \"2025-09-11T09:51:20.728Z\"}, \"fetched_at\": {\"$date\": \"2025-09-11T11:50:10.315Z\"}, \"from\": \"The Miro Team <your@product.miro.com>\", \"labels\": [\"IMPORTANT\", \"CATEGORY_UPDATES\", \"INBOX\"], \"snippet\": \"Get started in three simple steps. \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f\", \"subject\": \"Welcome to M...", "commandName": "find", "databaseName": "smart_email_db", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 189419, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:26:17,019 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:26:17,020 [INFO] services.db_service - Fetched 9 unclassified emails from MongoDB
2025-09-11 17:26:17,148 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 2034.7537000197917, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:26:17,183 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 2051.1822000844404, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:26:17,215 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b8de34050fdb552674a8"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 2044.8870999971405, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:30:12,610 [INFO] services.db_service - Connecting to MongoDB at mongodb+srv://***:***@cluster0.yrdrirj.mongodb.net/ (db='smart_email_db', collection='emails')
2025-09-11 17:30:12,778 [DEBUG] pymongo.topology - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}}
2025-09-11 17:30:12,778 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "previousDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:30:12,779 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:12,779 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:12,779 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:12,779 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:12,782 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:12,783 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:12,784 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}}
2025-09-11 17:30:12,784 [DEBUG] pymongo.serverSelection - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "remainingTimeMS": 4999}
2025-09-11 17:30:12,915 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:30:12,922 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:30:12,926 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:30:12,934 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 189491, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 18.999999971129, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"ismaster\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"availabilityZone\": \"aps1-az3\", \"region\": \"AP_SOUTH_1\", \"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\", \"workloadType\": \"OPERATIONAL\", \"provider\": \"AWS\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:00:08Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:00:08Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes..."}
2025-09-11 17:30:12,940 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:12,941 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "previousDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:30:12,942 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:12,942 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:12,943 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 189491, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:30:12,943 [DEBUG] pymongo.connection - {"message": "Connection created", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:30:12,959 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 181946, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 36.52000008150935, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"diskState\": \"READY\", \"provider\": \"AWS\", \"region\": \"AP_SOUTH_1\", \"availabilityZone\": \"aps1-az1\", \"nodeType\": \"ELECTABLE\", \"workloadType\": \"OPERATIONAL\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:00:08Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:00:08Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:30:12,961 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:12,962 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 179693, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 35.27430002577603, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"region\": \"AP_SOUTH_1\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:00:08Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:00:08Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:30:12,962 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "previousDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:30:12,965 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:12,966 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "previousDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03527430002577603>]>"}
2025-09-11 17:30:12,967 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 181946, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:30:12,969 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 179693, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:30:13,211 [DEBUG] pymongo.connection - {"message": "Connection ready", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.11413389991503209}
2025-09-11 17:30:13,212 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.26923450001049787}
2025-09-11 17:30:13,212 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "command": "{\"buildinfo\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"iVfEHspgS0uTRnh7mt6RoA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"y+Alr6/40ILK4kTKjD03vATvv4s=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"admin\"}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,251 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "durationMS": 38.928999999999995, "reply": "{\"version\": \"8.0.13\", \"gitVersion\": \"8dc5cd2a30c4524132e2d44bb314544dc477e611\", \"modules\": [\"enterprise\"], \"allocator\": \"tcmalloc-google\", \"javascriptEngine\": \"mozjs\", \"sysInfo\": \"deprecated\", \"versionArray\": [8, 13], \"bits\": 64, \"maxBsonObjectSize\": 16777216, \"storageEngines\": [\"devnull\", \"inMemory\", \"queryable_wt\", \"wiredTiger\"], \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"y+Alr6/40ILK4kTKjD03vATvv4s=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,251 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:30:13,251 [INFO] services.db_service - Connected to MongoDB successfully
2025-09-11 17:30:13,252 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03527430002577603>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}}
2025-09-11 17:30:13,252 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03527430002577603>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,252 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,252 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00012470001820474863}
2025-09-11 17:30:13,253 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"unique\": true, \"name\": \"provider_msgid_unique\", \"key\": {\"provider\": 1, \"provider_message_id\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"iVfEHspgS0uTRnh7mt6RoA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"y+Alr6/40ILK4kTKjD03vATvv4s=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,313 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "durationMS": 60.047999999999995, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"y+Alr6/40ILK4kTKjD03vATvv4s=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,313 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:30:13,313 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03527430002577603>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}}
2025-09-11 17:30:13,314 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03527430002577603>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,314 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,314 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00014349992852658033}
2025-09-11 17:30:13,314 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"date_idx\", \"key\": {\"date\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"iVfEHspgS0uTRnh7mt6RoA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"y+Alr6/40ILK4kTKjD03vATvv4s=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,354 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "durationMS": 40.071000000000005, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"y+Alr6/40ILK4kTKjD03vATvv4s=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,355 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:30:13,356 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03527430002577603>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}}
2025-09-11 17:30:13,356 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03527430002577603>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,357 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,357 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0004669999470934272}
2025-09-11 17:30:13,358 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"from_idx\", \"key\": {\"from\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"iVfEHspgS0uTRnh7mt6RoA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"y+Alr6/40ILK4kTKjD03vATvv4s=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,405 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "durationMS": 47.207, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"y+Alr6/40ILK4kTKjD03vATvv4s=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,406 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:30:13,407 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03527430002577603>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}}
2025-09-11 17:30:13,408 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03527430002577603>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,408 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,408 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0002874999772757292}
2025-09-11 17:30:13,409 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"labels_idx\", \"key\": {\"labels\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"iVfEHspgS0uTRnh7mt6RoA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"y+Alr6/40ILK4kTKjD03vATvv4s=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,452 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "durationMS": 43.312000000000005, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"y+Alr6/40ILK4kTKjD03vATvv4s=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:13,452 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:30:13,453 [INFO] services.db_service - MongoDB indexes ensured
2025-09-11 17:30:14,778 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03527430002577603>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}}
2025-09-11 17:30:14,779 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03527430002577603>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:14,779 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:14,779 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00011329993139952421}
2025-09-11 17:30:14,779 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "command": "{\"find\": \"emails\", \"sort\": {\"date\": -1}, \"limit\": 10, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"iVfEHspgS0uTRnh7mt6RoA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592008, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"y+Alr6/40ILK4kTKjD03vATvv4s=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "find", "databaseName": "smart_email_db", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:14,813 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "durationMS": 33.993, "reply": "{\"cursor\": {\"firstBatch\": [{\"_id\": {\"$oid\": \"68c29b952c6f45e31c3c8e91\"}, \"provider\": \"gmail\", \"provider_message_id\": \"1993319d67463407\", \"created_at\": {\"$date\": \"2025-09-11T09:51:20.728Z\"}, \"fetched_at\": {\"$date\": \"2025-09-11T11:50:10.315Z\"}, \"from\": \"The Miro Team <your@product.miro.com>\", \"labels\": [\"IMPORTANT\", \"CATEGORY_UPDATES\", \"INBOX\"], \"snippet\": \"Get started in three simple steps. \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f \u200c \u034f\", \"subject\": \"Welcome to M...", "commandName": "find", "databaseName": "smart_email_db", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:14,816 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:30:14,817 [INFO] services.db_service - Fetched 9 unclassified emails from MongoDB
2025-09-11 17:30:19,359 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03527430002577603>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}}
2025-09-11 17:30:19,359 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03527430002577603>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:19,360 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:19,360 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0001466000685468316}
2025-09-11 17:30:19,360 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "command": "{\"update\": \"emails\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"iVfEHspgS0uTRnh7mt6RoA==\", \"subType\": \"04\"}}}, \"txnNumber\": 1, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592010, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"5buYHraEtfntiBhppK8QOPfjIag=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\", \"updates\": [{\"q\": {\"_id\": {\"$oid\": \"68c29b952c6f45e31c3c8e91\"}}, \"u\": {\"$set\": {\"classifications.category\": \"Uncategorized\", \"classifications.classified_at\": {\"$date\": \"2025-09-11T12:00:19.359Z\"}}}}]}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:19,394 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "durationMS": 33.812000000000005, "reply": "{\"n\": 1, \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592015, \"i\": 1}}, \"t\": 75}, \"nModified\": 1, \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592015, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"BLrirfIsWqKFn17xTagQzPCyXM0=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592015, \"i\": 1}}}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:19,395 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:30:22,163 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03527430002577603>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}}
2025-09-11 17:30:22,164 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03652000008150935>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.018999999971129>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03527430002577603>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:22,165 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:22,166 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0007505000103265047}
2025-09-11 17:30:22,167 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "command": "{\"update\": \"emails\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"iVfEHspgS0uTRnh7mt6RoA==\", \"subType\": \"04\"}}}, \"txnNumber\": 2, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592015, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"BLrirfIsWqKFn17xTagQzPCyXM0=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\", \"updates\": [{\"q\": {\"_id\": {\"$oid\": \"68c29b952c6f45e31c3c8e90\"}}, \"u\": {\"$set\": {\"classifications.category\": \"Uncategorized\", \"classifications.classified_at\": {\"$date\": \"2025-09-11T12:00:22.162Z\"}}}}]}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:22,214 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "durationMS": 46.832, "reply": "{\"n\": 1, \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592018, \"i\": 3}}, \"t\": 75}, \"nModified\": 1, \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592018, \"i\": 3}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"UgpzipBDhNrUDSurSgVECbPP040=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592018, \"i\": 3}}}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 5705, "operationId": 5705, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:22,215 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:30:22,974 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 189491, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10029.786699917167, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"isWritablePrimary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"region\": \"AP_SOUTH_1\", \"availabilityZone\": \"aps1-az3\", \"workloadType\": \"OPERATIONAL\", \"provider\": \"AWS\", \"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592019, \"i\": 2}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:00:19Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592019, \"i\": 2}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:00:19Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000..."}
2025-09-11 17:30:22,976 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 189491, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:30:22,996 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 179693, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10027.292699902318, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\", \"region\": \"AP_SOUTH_1\", \"nodeType\": \"ELECTABLE\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592019, \"i\": 2}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:00:19Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592019, \"i\": 2}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:00:19Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:30:22,998 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 181946, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10030.710499966517, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"availabilityZone\": \"aps1-az1\", \"nodeType\": \"ELECTABLE\", \"provider\": \"AWS\", \"region\": \"AP_SOUTH_1\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592019, \"i\": 2}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:00:19Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592019, \"i\": 2}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:00:19Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:30:22,999 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 179693, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:30:23,001 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 181946, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:30:32,271 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.033728260081261396>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.020686219981871548>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03304638003464788>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}}
2025-09-11 17:30:32,271 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.033728260081261396>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.020686219981871548>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03304638003464788>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:32,272 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:32,272 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00014050002209842205}
2025-09-11 17:30:32,272 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "command": "{\"update\": \"emails\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"iVfEHspgS0uTRnh7mt6RoA==\", \"subType\": \"04\"}}}, \"txnNumber\": 3, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592018, \"i\": 3}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"UgpzipBDhNrUDSurSgVECbPP040=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\", \"updates\": [{\"q\": {\"_id\": {\"$oid\": \"68c29b952c6f45e31c3c8e8f\"}}, \"u\": {\"$set\": {\"classifications.category\": \"Uncategorized\", \"classifications.classified_at\": {\"$date\": \"2025-09-11T12:00:32.271Z\"}}}}]}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:32,305 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "durationMS": 32.86, "reply": "{\"n\": 1, \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592028, \"i\": 2}}, \"t\": 75}, \"nModified\": 1, \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592028, \"i\": 2}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"PDEgxIHhG9LXxUXRzrpNct2uJ3E=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592028, \"i\": 2}}}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 28145, "operationId": 28145, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:32,305 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:30:32,986 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 189491, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10009.472299949266, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"isWritablePrimary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"availabilityZone\": \"aps1-az3\", \"nodeType\": \"ELECTABLE\", \"provider\": \"AWS\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"region\": \"AP_SOUTH_1\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592028, \"i\": 3}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:00:28Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592028, \"i\": 3}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:00:28Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000..."}
2025-09-11 17:30:32,987 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 189491, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:30:32,998 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 179693, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 9996.168400044553, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\", \"region\": \"AP_SOUTH_1\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592028, \"i\": 3}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:00:28Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592028, \"i\": 3}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:00:28Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:30:32,998 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 179693, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:30:33,001 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 181946, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 9999.10929996986, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"availabilityZone\": \"aps1-az1\", \"nodeType\": \"ELECTABLE\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"region\": \"AP_SOUTH_1\", \"provider\": \"AWS\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592028, \"i\": 3}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:00:28Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592028, \"i\": 3}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:00:28Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:30:33,001 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 181946, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:30:42,995 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 189491, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10007.408399949782, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"isWritablePrimary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"region\": \"AP_SOUTH_1\", \"nodeType\": \"ELECTABLE\", \"provider\": \"AWS\", \"diskState\": \"READY\", \"workloadType\": \"OPERATIONAL\", \"availabilityZone\": \"aps1-az3\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592038, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:00:38Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592038, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:00:38Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000..."}
2025-09-11 17:30:42,996 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 189491, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:30:43,002 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 181946, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10000.427799997851, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"availabilityZone\": \"aps1-az1\", \"nodeType\": \"ELECTABLE\", \"provider\": \"AWS\", \"region\": \"AP_SOUTH_1\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592038, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:00:38Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592038, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:00:38Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:30:43,004 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 181946, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:30:43,008 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 179693, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10009.057199931704, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"nodeType\": \"ELECTABLE\", \"region\": \"AP_SOUTH_1\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\", \"diskState\": \"READY\", \"workloadType\": \"OPERATIONAL\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592038, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:00:38Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592038, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:00:38Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:30:43,009 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 179693, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:30:43,776 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.029615898458287125>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.023008760775439445>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03242464321199805>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}}
2025-09-11 17:30:43,777 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.029615898458287125>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.023008760775439445>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03242464321199805>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:43,778 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:43,778 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0005177999846637249}
2025-09-11 17:30:43,779 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "command": "{\"update\": \"emails\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"iVfEHspgS0uTRnh7mt6RoA==\", \"subType\": \"04\"}}}, \"txnNumber\": 4, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592028, \"i\": 2}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"PDEgxIHhG9LXxUXRzrpNct2uJ3E=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\", \"updates\": [{\"q\": {\"_id\": {\"$oid\": \"68c2750b2c6f45e31c3bdb2b\"}}, \"u\": {\"$set\": {\"classifications.category\": \"Uncategorized\", \"classifications.classified_at\": {\"$date\": \"2025-09-11T12:00:43.776Z\"}}}}]}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 23281, "operationId": 23281, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:43,812 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "durationMS": 32.644, "reply": "{\"n\": 1, \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592040, \"i\": 1}}, \"t\": 75}, \"nModified\": 1, \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592040, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"10FagS2NAmcjOYEWdBXIc1eXI4I=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592040, \"i\": 1}}}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 23281, "operationId": 23281, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:43,812 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:30:48,671 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.029615898458287125>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.023008760775439445>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03242464321199805>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}}
2025-09-11 17:30:48,672 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.029615898458287125>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.023008760775439445>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03242464321199805>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:48,673 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:48,673 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0005128999473527074}
2025-09-11 17:30:48,674 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "command": "{\"update\": \"emails\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"iVfEHspgS0uTRnh7mt6RoA==\", \"subType\": \"04\"}}}, \"txnNumber\": 5, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592040, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"10FagS2NAmcjOYEWdBXIc1eXI4I=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\", \"updates\": [{\"q\": {\"_id\": {\"$oid\": \"68c270332c6f45e31c3bdb2a\"}}, \"u\": {\"$set\": {\"classifications.category\": \"Uncategorized\", \"classifications.classified_at\": {\"$date\": \"2025-09-11T12:00:48.671Z\"}}}}]}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 16827, "operationId": 16827, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:48,710 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "durationMS": 36.358000000000004, "reply": "{\"n\": 1, \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592045, \"i\": 1}}, \"t\": 75}, \"nModified\": 1, \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592045, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"7NaXbFMYV1PVnVIXiuv489Lzv1U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592045, \"i\": 1}}}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 16827, "operationId": 16827, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:48,711 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:30:52,321 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.029615898458287125>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.023008760775439445>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03242464321199805>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}}
2025-09-11 17:30:52,322 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.029615898458287125>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.023008760775439445>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.03242464321199805>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:52,323 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:52,323 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0004141998942941427}
2025-09-11 17:30:52,324 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "command": "{\"update\": \"emails\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"iVfEHspgS0uTRnh7mt6RoA==\", \"subType\": \"04\"}}}, \"txnNumber\": 6, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592045, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"7NaXbFMYV1PVnVIXiuv489Lzv1U=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\", \"updates\": [{\"q\": {\"_id\": {\"$oid\": \"68c270332c6f45e31c3bdb29\"}}, \"u\": {\"$set\": {\"classifications.category\": \"Uncategorized\", \"classifications.classified_at\": {\"$date\": \"2025-09-11T12:00:52.321Z\"}}}}]}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 9961, "operationId": 9961, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:52,372 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "durationMS": 48.120999999999995, "reply": "{\"n\": 1, \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592048, \"i\": 2}}, \"t\": 75}, \"nModified\": 1, \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592048, \"i\": 2}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"WAbg+ErvxKiSPfkH+h+Qsf2/bcM=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592048, \"i\": 2}}}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 9961, "operationId": 9961, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:52,373 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:30:53,007 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 189491, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10010.566900018603, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"isWritablePrimary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"region\": \"AP_SOUTH_1\", \"nodeType\": \"ELECTABLE\", \"provider\": \"AWS\", \"diskState\": \"READY\", \"workloadType\": \"OPERATIONAL\", \"availabilityZone\": \"aps1-az3\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592049, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:00:49Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592049, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:00:49Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000..."}
2025-09-11 17:30:53,009 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 189491, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:30:53,013 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 181946, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10008.2543999888, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"availabilityZone\": \"aps1-az1\", \"nodeType\": \"ELECTABLE\", \"provider\": \"AWS\", \"region\": \"AP_SOUTH_1\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592049, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:00:49Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592049, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:00:49Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:30:53,014 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 181946, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:30:53,016 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 179693, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 10005.890899919905, "reply": "{\"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"availabilityZone\": \"aps1-az2\", \"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\", \"workloadType\": \"OPERATIONAL\", \"region\": \"AP_SOUTH_1\", \"provider\": \"AWS\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592049, \"i\": 1}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:00:49Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592049, \"i\": 1}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:00:49Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTime\": {\"$date\": \"20..."}
2025-09-11 17:30:53,017 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "driverConnectionId": 1, "serverConnectionId": 179693, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:30:55,764 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027893598763272173>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024450208628922707>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.0307066945694387>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}}
2025-09-11 17:30:55,765 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027893598763272173>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024450208628922707>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.0307066945694387>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:55,766 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:55,766 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0003322999691590667}
2025-09-11 17:30:55,766 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "command": "{\"update\": \"emails\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"iVfEHspgS0uTRnh7mt6RoA==\", \"subType\": \"04\"}}}, \"txnNumber\": 7, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592048, \"i\": 2}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"WAbg+ErvxKiSPfkH+h+Qsf2/bcM=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\", \"updates\": [{\"q\": {\"_id\": {\"$oid\": \"68c270332c6f45e31c3bdb28\"}}, \"u\": {\"$set\": {\"classifications.category\": \"Uncategorized\", \"classifications.classified_at\": {\"$date\": \"2025-09-11T12:00:55.764Z\"}}}}]}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 491, "operationId": 491, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:55,812 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "durationMS": 45.661, "reply": "{\"n\": 1, \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592052, \"i\": 1}}, \"t\": 75}, \"nModified\": 1, \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592052, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"MbSJnvdbVhT2oC+E4djtRG9hVno=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592052, \"i\": 1}}}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 491, "operationId": 491, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:55,812 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:30:58,356 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027893598763272173>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024450208628922707>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.0307066945694387>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}}
2025-09-11 17:30:58,356 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027893598763272173>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024450208628922707>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.0307066945694387>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:58,356 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:58,356 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00015789992175996304}
2025-09-11 17:30:58,357 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "command": "{\"update\": \"emails\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"iVfEHspgS0uTRnh7mt6RoA==\", \"subType\": \"04\"}}}, \"txnNumber\": 8, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592052, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"MbSJnvdbVhT2oC+E4djtRG9hVno=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\", \"updates\": [{\"q\": {\"_id\": {\"$oid\": \"68c270332c6f45e31c3bdb27\"}}, \"u\": {\"$set\": {\"classifications.category\": \"Uncategorized\", \"classifications.classified_at\": {\"$date\": \"2025-09-11T12:00:58.356Z\"}}}}]}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 2995, "operationId": 2995, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:58,399 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "durationMS": 42.626999999999995, "reply": "{\"n\": 1, \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592054, \"i\": 1}}, \"t\": 75}, \"nModified\": 1, \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592054, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"oeTTP/e1tdk3874YXB6pf+Od2d8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592054, \"i\": 1}}}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 2995, "operationId": 2995, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:30:58,400 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:31:01,750 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027893598763272173>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024450208628922707>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.0307066945694387>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}}
2025-09-11 17:31:01,751 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x0000022944A7A200>", "operation": "update", "topologyDescription": "<TopologyDescription id: 68c2b9cc90e4e6e9d1db5e89, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.027893598763272173>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.024450208628922707>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.0307066945694387>]>", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:31:01,751 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:31:01,752 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0004632000345736742}
2025-09-11 17:31:01,752 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "command": "{\"update\": \"emails\", \"ordered\": true, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"iVfEHspgS0uTRnh7mt6RoA==\", \"subType\": \"04\"}}}, \"txnNumber\": 9, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592054, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"oeTTP/e1tdk3874YXB6pf+Od2d8=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\", \"updates\": [{\"q\": {\"_id\": {\"$oid\": \"68c270332c6f45e31c3bdb26\"}}, \"u\": {\"$set\": {\"classifications.category\": \"Uncategorized\", \"classifications.classified_at\": {\"$date\": \"2025-09-11T12:01:01.749Z\"}}}}]}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 11942, "operationId": 11942, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:31:01,785 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "durationMS": 32.369, "reply": "{\"n\": 1, \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592058, \"i\": 1}}, \"t\": 75}, \"nModified\": 1, \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592058, \"i\": 1}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"veFqwmCiYopST5StdpVrM4XTzuA=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592058, \"i\": 1}}}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 11942, "operationId": 11942, "driverConnectionId": 1, "serverConnectionId": 189504, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:31:01,785 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:31:02,128 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 9118.675399920903, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:31:02,129 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 9111.450099968351, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:31:02,129 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2b9cc90e4e6e9d1db5e89"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 9114.638099912554, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:41:20,108 [INFO] services.db_service - Connecting to MongoDB at mongodb+srv://***:***@cluster0.yrdrirj.mongodb.net/ (db='smart_email_db', collection='emails')
2025-09-11 17:41:20,314 [DEBUG] pymongo.topology - {"message": "Starting topology monitoring", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}}
2025-09-11 17:41:20,314 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "previousDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: Unknown, servers: []>", "newDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:41:20,315 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,315 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,315 [DEBUG] pymongo.topology - {"message": "Starting server monitoring", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,315 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,317 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,319 [DEBUG] pymongo.connection - {"message": "Connection pool created", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,320 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}}
2025-09-11 17:41:20,320 [DEBUG] pymongo.serverSelection - {"message": "Waiting for suitable server to become available", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "remainingTimeMS": 4999}
2025-09-11 17:41:20,477 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:41:20,486 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:41:20,524 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "driverConnectionId": 1, "serverConnectionId": 182213, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 46.14009999204427, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f07093333043a72a9e0\"}, \"counter\": 4}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"nodeType\": \"ELECTABLE\", \"region\": \"AP_SOUTH_1\", \"provider\": \"AWS\", \"workloadType\": \"OPERATIONAL\", \"diskState\": \"READY\", \"availabilityZone\": \"aps1-az1\"}, \"me\": \"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 2}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:11:17Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 2}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:11:17Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localTim..."}
2025-09-11 17:41:20,534 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "driverConnectionId": 1, "serverConnectionId": 189809, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 47.14130004867911, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f452c6f45e31c1c7143\"}, \"counter\": 6}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"ismaster\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"region\": \"AP_SOUTH_1\", \"availabilityZone\": \"aps1-az3\", \"workloadType\": \"OPERATIONAL\", \"provider\": \"AWS\", \"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\"}, \"me\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 4}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:11:17Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 4}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:11:17Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes..."}
2025-09-11 17:41:20,535 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,538 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "previousDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:41:20,540 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,540 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "previousDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetNoPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.04714130004867911>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>"}
2025-09-11 17:41:20,542 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "buildinfo", "topologyDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.04714130004867911>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,544 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,544 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "driverConnectionId": 1, "serverConnectionId": 189809, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:41:20,544 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "driverConnectionId": 1, "serverConnectionId": 182213, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:41:20,544 [DEBUG] pymongo.connection - {"message": "Connection created", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:41:20,589 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "driverConnectionId": 1, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false}
2025-09-11 17:41:20,635 [DEBUG] pymongo.topology - {"message": "Server heartbeat succeeded", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "driverConnectionId": 1, "serverConnectionId": 179944, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": false, "durationMS": 44.68540009111166, "reply": "{\"helloOk\": true, \"topologyVersion\": {\"processId\": {\"$oid\": \"68b89f83127cce0eca6ca06f\"}, \"counter\": 3}, \"hosts\": [\"ac-nfej659-shard-00-00.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\"], \"setName\": \"atlas-z0rr8u-shard-0\", \"setVersion\": 16, \"secondary\": true, \"primary\": \"ac-nfej659-shard-00-01.yrdrirj.mongodb.net:27017\", \"tags\": {\"region\": \"AP_SOUTH_1\", \"workloadType\": \"OPERATIONAL\", \"provider\": \"AWS\", \"availabilityZone\": \"aps1-az2\", \"diskState\": \"READY\", \"nodeType\": \"ELECTABLE\"}, \"me\": \"ac-nfej659-shard-00-02.yrdrirj.mongodb.net:27017\", \"lastWrite\": {\"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 13}}, \"t\": 75}, \"lastWriteDate\": {\"$date\": \"2025-09-11T12:11:17Z\"}, \"majorityOpTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 13}}, \"t\": 75}, \"majorityWriteDate\": {\"$date\": \"2025-09-11T12:11:17Z\"}}, \"maxBsonObjectSize\": 16777216, \"maxMessageSizeBytes\": 48000000, \"maxWriteBatchSize\": 100000, \"localT..."}
2025-09-11 17:41:20,636 [DEBUG] pymongo.connection - {"message": "Connection pool ready", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,637 [DEBUG] pymongo.topology - {"message": "Topology description changed", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "previousDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.04714130004867911>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: Unknown, rtt: None>]>", "newDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.04714130004867911>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04468540009111166>]>"}
2025-09-11 17:41:20,639 [DEBUG] pymongo.topology - {"message": "Server heartbeat started", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "driverConnectionId": 1, "serverConnectionId": 179944, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true}
2025-09-11 17:41:20,830 [DEBUG] pymongo.connection - {"message": "Connection ready", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.1537121000001207}
2025-09-11 17:41:20,831 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.287013900000602}
2025-09-11 17:41:20,831 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "command": "{\"buildinfo\": 1, \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ESZQ3mtmTa2gAPudwkZQwA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 21}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"Q6KFeBBM/OwqxHhpGXZF2EmfFEI=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"admin\"}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189810, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,870 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "durationMS": 39.156000000000006, "reply": "{\"version\": \"8.0.13\", \"gitVersion\": \"8dc5cd2a30c4524132e2d44bb314544dc477e611\", \"modules\": [\"enterprise\"], \"allocator\": \"tcmalloc-google\", \"javascriptEngine\": \"mozjs\", \"sysInfo\": \"deprecated\", \"versionArray\": [8, 13], \"bits\": 64, \"maxBsonObjectSize\": 16777216, \"storageEngines\": [\"devnull\", \"inMemory\", \"queryable_wt\", \"wiredTiger\"], \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 33}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"Q6KFeBBM/OwqxHhpGXZF2EmfFEI=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 33}}}", "commandName": "buildinfo", "databaseName": "admin", "requestId": 26500, "operationId": 26500, "driverConnectionId": 1, "serverConnectionId": 189810, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,871 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:41:20,871 [INFO] services.db_service - Connected to MongoDB successfully
2025-09-11 17:41:20,872 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x00000258C833A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.04714130004867911>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04468540009111166>]>", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}}
2025-09-11 17:41:20,873 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x00000258C833A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.04714130004867911>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04468540009111166>]>", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,874 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,874 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0004896000027656555}
2025-09-11 17:41:20,875 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"unique\": true, \"name\": \"provider_msgid_unique\", \"key\": {\"provider\": 1, \"provider_message_id\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ESZQ3mtmTa2gAPudwkZQwA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 33}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"Q6KFeBBM/OwqxHhpGXZF2EmfFEI=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189810, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,940 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "durationMS": 65.528, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 38}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"Q6KFeBBM/OwqxHhpGXZF2EmfFEI=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 38}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 19169, "operationId": 19169, "driverConnectionId": 1, "serverConnectionId": 189810, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,941 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:41:20,941 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x00000258C833A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.04714130004867911>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04468540009111166>]>", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}}
2025-09-11 17:41:20,942 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x00000258C833A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.04714130004867911>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04468540009111166>]>", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,943 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:20,943 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0002770000137388706}
2025-09-11 17:41:20,943 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"date_idx\", \"key\": {\"date\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ESZQ3mtmTa2gAPudwkZQwA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 38}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"Q6KFeBBM/OwqxHhpGXZF2EmfFEI=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189810, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:21,003 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "durationMS": 59.822, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 43}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"Q6KFeBBM/OwqxHhpGXZF2EmfFEI=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 43}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 15724, "operationId": 15724, "driverConnectionId": 1, "serverConnectionId": 189810, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:21,003 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:41:21,003 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x00000258C833A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.04714130004867911>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04468540009111166>]>", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}}
2025-09-11 17:41:21,004 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x00000258C833A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.04714130004867911>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04468540009111166>]>", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:21,004 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:21,004 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00013930001296103}
2025-09-11 17:41:21,004 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"from_idx\", \"key\": {\"from\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ESZQ3mtmTa2gAPudwkZQwA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 43}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"Q6KFeBBM/OwqxHhpGXZF2EmfFEI=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189810, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:21,053 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "durationMS": 48.264, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 48}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"Q6KFeBBM/OwqxHhpGXZF2EmfFEI=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 48}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 11478, "operationId": 11478, "driverConnectionId": 1, "serverConnectionId": 189810, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:21,053 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:41:21,053 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x00000258C833A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.04714130004867911>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04468540009111166>]>", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}}
2025-09-11 17:41:21,053 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x00000258C833A200>", "operation": "createIndexes", "topologyDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.04714130004867911>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04468540009111166>]>", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:21,053 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:21,054 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00012000009883195162}
2025-09-11 17:41:21,054 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "command": "{\"createIndexes\": \"emails\", \"indexes\": [{\"name\": \"labels_idx\", \"key\": {\"labels\": 1}}], \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ESZQ3mtmTa2gAPudwkZQwA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 48}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"Q6KFeBBM/OwqxHhpGXZF2EmfFEI=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189810, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:21,104 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "durationMS": 49.82, "reply": "{\"numIndexesBefore\": 5, \"numIndexesAfter\": 5, \"commitQuorum\": \"votingMembers\", \"note\": \"all indexes already exist\", \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 52}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"Q6KFeBBM/OwqxHhpGXZF2EmfFEI=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 52}}}", "commandName": "createIndexes", "databaseName": "smart_email_db", "requestId": 29358, "operationId": 29358, "driverConnectionId": 1, "serverConnectionId": 189810, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:21,104 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:41:21,104 [INFO] services.db_service - MongoDB indexes ensured
2025-09-11 17:41:21,138 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-11 17:41:21,138 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-11 17:41:21,144 [INFO] googleapiclient.discovery_cache - file_cache is only supported with oauth2client<4.0.0
2025-09-11 17:41:21,147 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-11 17:41:21,147 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-11 17:41:21,147 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-11 17:41:21,147 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-11 17:41:21,148 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-11 17:41:21,148 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-11 17:41:21,156 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages?labelIds=INBOX&maxResults=10&alt=json
2025-09-11 17:41:22,106 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/1993797cbb72a9f8?alt=json
2025-09-11 17:41:22,465 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199374924cbd9c11?alt=json
2025-09-11 17:41:22,835 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199374018a3537ad?alt=json
2025-09-11 17:41:23,208 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199372f48f5a3d5a?alt=json
2025-09-11 17:41:23,732 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/1993718a428b45ee?alt=json
2025-09-11 17:41:24,174 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/19936d3d33cfe857?alt=json
2025-09-11 17:41:24,780 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199336433472cb67?alt=json
2025-09-11 17:41:25,177 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199331aaa4dc15d3?alt=json
2025-09-11 17:41:25,660 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/1993319d67463407?alt=json
2025-09-11 17:41:26,054 [DEBUG] googleapiclient.discovery - URL being requested: GET https://gmail.googleapis.com/gmail/v1/users/me/messages/199330cea0a5cb8a?alt=json
2025-09-11 17:41:26,484 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-11 17:41:26,484 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-11 17:41:26,485 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-11 17:41:26,485 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-11 17:41:26,485 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-11 17:41:26,485 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-11 17:41:26,486 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "<function writable_server_selector at 0x00000258C833A200>", "operation": "insert", "operationId": -790891797, "topologyDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.04714130004867911>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04468540009111166>]>", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}}
2025-09-11 17:41:26,486 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "<function writable_server_selector at 0x00000258C833A200>", "operation": "insert", "operationId": -790891797, "topologyDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.04714130004867911>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04468540009111166>]>", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:26,487 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:26,487 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.0001916999462991953}
2025-09-11 17:41:26,487 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "command": "{\"update\": \"emails\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ESZQ3mtmTa2gAPudwkZQwA==\", \"subType\": \"04\"}}}, \"txnNumber\": 1, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592677, \"i\": 52}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"Q6KFeBBM/OwqxHhpGXZF2EmfFEI=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\", \"updates\": [{\"q\": {\"provider\": \"gmail\", \"provider_message_id\": \"1993797cbb72a9f8\"}, \"u\": {\"$set\": {\"provider\": \"gmail\", \"provider_message_id\": \"1993797cbb72a9f8\", \"thread_id\": \"1993797cbb72a9f8\", \"from\": \"Rajan Malaviya <rajanmalaviya111@gmail.com>\", \"subject\": \"Test Mail\", \"snippet\": \"This is the testing email. Thanks!!\", \"labels\": [\"IMPORTANT\", \"CATEGORY_PERSONAL\", \"INBOX\"], \"fetched_at\": {\"$date\": \"2025-09-11T12:11:26.486Z\"}}, \"$setOnInsert\": {\"created_at\": {\"$date\": \"2025-09-11T12:11:26.486Z\"}}}, \"upsert\": true}, {\"q\": {\"provider\": \"gmail\", \"provider_message_id\": \"199374924cbd9c11\"}, \"u\": {\"$set\": {\"provider\": \"gmail\", \"provider_message...", "commandName": "update", "databaseName": "smart_email_db", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 189810, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:26,540 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "durationMS": 52.699999999999996, "reply": "{\"n\": 10, \"electionId\": {\"$oid\": \"7fffffff000000000000004b\"}, \"opTime\": {\"ts\": {\"$timestamp\": {\"t\": 1757592683, \"i\": 13}}, \"t\": 75}, \"nModified\": 10, \"ok\": 1.0, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592683, \"i\": 13}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"4kXgGJTP14qGoK2a13cZ0DQso1c=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"operationTime\": {\"$timestamp\": {\"t\": 1757592683, \"i\": 13}}}", "commandName": "update", "databaseName": "smart_email_db", "requestId": 26962, "operationId": 26962, "driverConnectionId": 1, "serverConnectionId": 189810, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:26,540 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:41:26,540 [INFO] services.db_service - Bulk upsert complete: Upserted 0, Modified 10
2025-09-11 17:41:26,540 [INFO] __main__ - Upsert Results: {'upserted_count': 0, 'modified_count': 10}
2025-09-11 17:41:26,540 [INFO] __main__ - Upsert Results: {'upserted_count': 0, 'modified_count': 10}
2025-09-11 17:41:26,543 [DEBUG] pymongo.serverSelection - {"message": "Server selection started", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.04714130004867911>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04468540009111166>]>", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}}
2025-09-11 17:41:26,544 [DEBUG] pymongo.serverSelection - {"message": "Server selection succeeded", "selector": "Primary()", "operation": "find", "topologyDescription": "<TopologyDescription id: 68c2bc684f945109b2a1c629, topology_type: ReplicaSetWithPrimary, servers: [<ServerDescription ('ac-nfej659-shard-00-00.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04614009999204427>, <ServerDescription ('ac-nfej659-shard-00-01.yrdrirj.mongodb.net', 27017) server_type: RSPrimary, rtt: 0.04714130004867911>, <ServerDescription ('ac-nfej659-shard-00-02.yrdrirj.mongodb.net', 27017) server_type: RSSecondary, rtt: 0.04468540009111166>]>", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:26,544 [DEBUG] pymongo.connection - {"message": "Connection checkout started", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:26,544 [DEBUG] pymongo.connection - {"message": "Connection checked out", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1, "durationMS": 0.00012909993529319763}
2025-09-11 17:41:26,544 [DEBUG] pymongo.command - {"message": "Command started", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "command": "{\"find\": \"emails\", \"lsid\": {\"id\": {\"$binary\": {\"base64\": \"ESZQ3mtmTa2gAPudwkZQwA==\", \"subType\": \"04\"}}}, \"$clusterTime\": {\"clusterTime\": {\"$timestamp\": {\"t\": 1757592683, \"i\": 13}}, \"signature\": {\"hash\": {\"$binary\": {\"base64\": \"4kXgGJTP14qGoK2a13cZ0DQso1c=\", \"subType\": \"00\"}}, \"keyId\": 7501748260407607299}}, \"$db\": \"smart_email_db\"}", "commandName": "find", "databaseName": "smart_email_db", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 189810, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:26,732 [DEBUG] pymongo.command - {"message": "Command succeeded", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "durationMS": 188.144, "reply": "{\"cursor\": {\"firstBatch\": [{\"provider\": \"gmail\", \"provider_message_id\": \"199374924cbd9c11\", \"created_at\": {\"$date\": \"2025-09-11T06:46:15.035Z\"}, \"fetched_at\": {\"$date\": \"2025-09-11T12:11:26.486Z\"}, \"from\": \"MongoDB Atlas <mongodb-atlas@mongodb.com>\", \"labels\": [\"IMPORTANT\", \"CATEGORY_UPDATES\", \"INBOX\"], \"snippet\": \"ORGANIZATION Rajan&#39;s Org - 2025-09-10 PROJECT Project 0 This is an informational notice to ensure you&#39;re aware that you&#39;ve added &quot;Allow access from anywhere (0.0.0.0/0)&quot; to your\", \"subject\": \"You've added \"Allow access from anywhere (0.0.0.0/0)\" to your Network Permission List\", \"thread_id\": \"199374924cbd9c11\"}, {\"provider_message_id\": \"199374018a3537ad\", \"provider\": \"gmail\", \"created_at\": {\"$date\": \"2025-09-11T06:46:15.035Z\"}, \"fetched_at\": {\"$date\": \"2025-09-11T12:11:26.486Z\"}, \"from\": \"Google <no-reply@accounts.google.com>\", \"labels\": [\"IMPORTANT\", \"CATEGORY_UPDATES\", \"INBOX\"], \"snippet\": \"You allowed Smart Email Assistant access to some of your Go...", "commandName": "find", "databaseName": "smart_email_db", "requestId": 24464, "operationId": 24464, "driverConnectionId": 1, "serverConnectionId": 189810, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017}
2025-09-11 17:41:26,734 [DEBUG] pymongo.connection - {"message": "Connection checked in", "clientId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "driverConnectionId": 1}
2025-09-11 17:41:26,735 [INFO] services.db_service - Retrieved 10 emails from MongoDB
2025-09-11 17:41:26,735 [INFO] __main__ - Total stored emails in MongoDB: 10
2025-09-11 17:41:26,735 [INFO] __main__ - Total stored emails in MongoDB: 10
2025-09-11 17:41:27,113 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-00.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 6568.635299918242, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:41:27,114 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-01.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 6569.88199998159, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-11 17:41:27,228 [DEBUG] pymongo.topology - {"message": "Server heartbeat failed", "topologyId": {"$oid": "68c2bc684f945109b2a1c629"}, "serverHost": "ac-nfej659-shard-00-02.yrdrirj.mongodb.net", "serverPort": 27017, "awaited": true, "durationMS": 6589.063399937004, "failure": "\"_OperationCancelled('operation cancelled')\"", "driverConnectionId": 1}
2025-09-12 09:56:07,340 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-12 09:56:07,341 [INFO] services.gmail_service - Refreshing expired Gmail token...
2025-09-12 09:56:07,757 [INFO] services.gmail_service - Token refreshed successfully
2025-09-12 09:56:07,759 [INFO] services.gmail_service - Saved Gmail token.json for future runs
2025-09-12 09:56:07,813 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-12 09:56:07,814 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-12 09:56:07,814 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-12 09:56:12,837 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-12 09:56:12,839 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-12 09:56:12,840 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-12 09:56:12,901 [INFO] __main__ - Upsert Results: {'upserted_count': 2, 'modified_count': 8}
2025-09-12 09:56:13,102 [INFO] __main__ - Total stored emails in MongoDB: 12
2025-09-12 10:18:31,305 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-12 10:18:31,312 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-12 10:18:31,312 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-12 10:18:31,312 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-12 10:18:36,816 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-12 10:18:36,817 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-12 10:18:36,818 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-12 10:18:36,865 [INFO] __main__ - Upsert Results: {'upserted_count': 0, 'modified_count': 10}
2025-09-12 10:18:36,899 [INFO] __main__ - Total stored emails in MongoDB: 12
2025-09-12 10:25:23,465 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-12 10:25:23,474 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-12 10:25:23,474 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-12 10:25:23,474 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-12 10:25:28,582 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-12 10:25:28,582 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-12 10:25:28,583 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-12 10:25:28,648 [INFO] __main__ - Upsert Results: {'upserted_count': 1, 'modified_count': 9}
2025-09-12 10:25:28,684 [INFO] __main__ - Total stored emails in MongoDB: 13
2025-09-12 11:46:02,994 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-12 11:46:02,995 [INFO] services.gmail_service - Refreshing expired Gmail token...
2025-09-12 11:46:03,389 [INFO] services.gmail_service - Token refreshed successfully
2025-09-12 11:46:03,392 [INFO] services.gmail_service - Saved Gmail token.json for future runs
2025-09-12 11:46:03,412 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-12 11:46:03,413 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-12 11:46:03,414 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-12 11:46:08,907 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-12 11:46:08,908 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-12 11:46:08,909 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-12 11:46:08,955 [INFO] __main__ - Upsert Results: {'upserted_count': 0, 'modified_count': 10}
2025-09-12 11:46:08,985 [INFO] __main__ - Total stored emails in MongoDB: 13
2025-09-12 11:46:50,391 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-12 11:46:50,397 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-12 11:46:50,397 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-12 11:46:50,397 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-12 11:46:55,404 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-12 11:46:55,405 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-12 11:46:55,405 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-12 11:46:55,439 [INFO] __main__ - Upsert Results: {'upserted_count': 0, 'modified_count': 10}
2025-09-12 11:46:55,469 [INFO] __main__ - Total stored emails in MongoDB: 13
2025-09-12 11:53:07,783 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-12 11:53:07,789 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-12 11:53:07,789 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-12 11:53:07,789 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-12 11:53:13,967 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-12 11:53:13,968 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-12 11:53:13,969 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-12 11:53:14,011 [INFO] __main__ - Upsert Results: {'upserted_count': 0, 'modified_count': 10}
2025-09-12 11:53:14,044 [INFO] __main__ - Total stored emails in MongoDB: 13
2025-09-12 12:01:30,514 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-12 12:01:30,519 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-12 12:01:30,519 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-12 12:01:30,520 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-12 12:01:36,796 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-12 12:01:36,797 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-12 12:01:36,798 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-12 12:01:36,865 [INFO] __main__ - Upsert Results: {'upserted_count': 0, 'modified_count': 10}
2025-09-12 12:01:36,921 [INFO] __main__ - Total stored emails in MongoDB: 13
2025-09-12 12:05:23,059 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-12 12:05:23,067 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-12 12:05:23,067 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-12 12:05:23,068 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-12 12:05:28,301 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-12 12:05:28,302 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-12 12:05:28,304 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-12 12:05:28,339 [INFO] __main__ - Upsert Results: {'upserted_count': 0, 'modified_count': 10}
2025-09-12 12:05:28,372 [INFO] __main__ - Total stored emails in MongoDB: 13
2025-09-12 12:21:41,926 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-12 12:21:41,931 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-12 12:21:41,932 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-12 12:21:41,932 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-12 12:21:46,878 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-12 12:21:46,878 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-12 12:21:46,879 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-12 12:21:46,924 [INFO] __main__ - Upsert Results: {'upserted_count': 1, 'modified_count': 9}
2025-09-12 12:21:46,955 [INFO] __main__ - Total stored emails in MongoDB: 14
2025-09-12 12:22:12,054 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-12 12:22:12,060 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-12 12:22:12,061 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-12 12:22:12,061 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-12 12:22:17,179 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-12 12:22:17,180 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-12 12:22:17,182 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-12 12:22:17,224 [INFO] __main__ - Upsert Results: {'upserted_count': 0, 'modified_count': 10}
2025-09-12 12:22:17,261 [INFO] __main__ - Total stored emails in MongoDB: 14
2025-09-12 12:40:57,957 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-12 12:40:57,966 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-12 12:40:57,966 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-12 12:40:57,967 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-12 12:41:02,757 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-12 12:41:02,758 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-12 12:41:02,760 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-12 12:41:02,798 [INFO] __main__ - Upsert Results: {'upserted_count': 1, 'modified_count': 9}
2025-09-12 12:41:02,827 [INFO] __main__ - Total stored emails in MongoDB: 15
2025-09-12 12:58:10,239 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-12 12:58:10,240 [INFO] services.gmail_service - Refreshing expired Gmail token...
2025-09-12 12:58:10,619 [INFO] services.gmail_service - Token refreshed successfully
2025-09-12 12:58:10,622 [INFO] services.gmail_service - Saved Gmail token.json for future runs
2025-09-12 12:58:10,643 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-12 12:58:10,644 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-12 12:58:10,645 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-12 12:58:18,710 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-12 12:58:18,712 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-12 12:58:18,713 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-12 12:58:18,780 [INFO] __main__ - Upsert Results: {'upserted_count': 1, 'modified_count': 9}
2025-09-12 12:58:18,836 [INFO] __main__ - Total stored emails in MongoDB: 16
2025-09-12 15:57:52,609 [INFO] services.gmail_service - Performing Gmail login via OAuth flow...
2025-09-12 15:58:05,950 [INFO] services.gmail_service - Saved Gmail token.json for future runs
2025-09-12 15:58:05,987 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-12 15:58:05,990 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-12 15:58:05,992 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-12 15:58:12,660 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-12 15:58:12,660 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-12 15:58:12,661 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-12 15:58:12,704 [INFO] __main__ - Upsert Results: {'upserted_count': 0, 'modified_count': 10}
2025-09-12 15:58:12,742 [INFO] __main__ - Total stored emails in MongoDB: 16
2025-09-12 17:09:34,201 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-12 17:09:34,202 [INFO] services.gmail_service - Refreshing expired Gmail token...
2025-09-12 17:09:34,560 [INFO] services.gmail_service - Token refreshed successfully
2025-09-12 17:09:34,562 [INFO] services.gmail_service - Saved Gmail token.json for future runs
2025-09-12 17:09:34,576 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-12 17:09:34,577 [INFO] services.gmail_service - Fetching 5 emails from Gmail inbox...
2025-09-12 17:09:37,410 [INFO] services.gmail_service - Fetched 5 emails successfully
2025-09-12 17:32:43,553 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-12 17:32:43,575 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-12 17:32:43,575 [INFO] __main__ - Fetching up to 10 emails from Gmail...
2025-09-12 17:32:43,575 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-12 17:32:48,780 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-12 17:32:48,782 [INFO] __main__ - Fetched 10 emails from Gmail
2025-09-12 17:32:48,783 [INFO] __main__ - Storing fetched emails in MongoDB...
2025-09-12 17:32:48,835 [INFO] __main__ - Upsert Results: {'upserted_count': 0, 'modified_count': 10}
2025-09-12 17:32:48,999 [INFO] __main__ - Total stored emails in MongoDB: 17
2025-09-12 17:55:30,134 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-12 17:55:30,147 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-12 17:55:30,147 [INFO] main - Fetching up to 5 emails from Gmail...
2025-09-12 17:55:30,148 [INFO] services.gmail_service - Fetching 5 emails from Gmail inbox...
2025-09-12 17:55:33,883 [INFO] services.gmail_service - Fetched 5 emails successfully
2025-09-12 17:55:33,884 [INFO] main - Fetched 5 emails from Gmail
2025-09-13 09:15:35,535 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-13 09:15:35,537 [INFO] services.gmail_service - Refreshing expired Gmail token...
2025-09-13 09:15:36,378 [INFO] services.gmail_service - Token refreshed successfully
2025-09-13 09:15:36,381 [INFO] services.gmail_service - Saved Gmail token.json for future runs
2025-09-13 09:15:36,400 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-13 09:15:36,401 [INFO] main - Fetching up to 10 emails from Gmail...
2025-09-13 09:15:36,402 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-13 09:15:43,025 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-13 09:15:43,027 [INFO] main - Fetched 10 emails from Gmail
2025-09-13 09:25:35,051 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-13 09:25:35,099 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-13 09:25:35,099 [INFO] main - Fetching up to 10 emails from Gmail...
2025-09-13 09:25:35,100 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-13 09:25:43,789 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-13 09:25:43,789 [INFO] main - Fetched 10 emails from Gmail
2025-09-13 10:05:09,351 [INFO] services.gmail_service - Loaded existing Gmail token.json
2025-09-13 10:05:09,356 [INFO] services.gmail_service - Gmail API service initialized successfully
2025-09-13 10:05:09,357 [INFO] main - Fetching up to 10 emails from Gmail...
2025-09-13 10:05:09,357 [INFO] services.gmail_service - Fetching 10 emails from Gmail inbox...
2025-09-13 10:05:14,791 [INFO] services.gmail_service - Fetched 10 emails successfully
2025-09-13 10:05:14,792 [INFO] main - Fetched 10 emails from Gmail
